---
title: L03-线性代数
date: 2022-05-14 16:56:46
tags: 人工智能、机器学习、深度学习
categories: 
- 人工智能
- 人工智能数学基础
cover: https://tva1.sinaimg.cn/large/e6c9d24ely1h27xhn6rarj210c0ligo3.jpg
---

# 引入

​       今有雉兔同笼,上有三十五头,下有九十四足,问雉兔各几何?——孙子算经

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xlrvnhej20ua0kkmz6.jpg" style="zoom:33%;" />

# 线性方程组

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xn44lfuj20o80m6wg6.jpg" style="zoom:33%;" />

- **由系数唯一确定**
- 通常由**高斯消元法**解决

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xpbpf8nj20wq0go0u0.jpg" style="zoom:33%;" />

- **齐次**线性方程组：常数项全部为0
- **非齐次**线性方程组：常数项不全部为0

# 行列式

​       对于方阵（行数=列数）定义一种特别的运算——**行列式**：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xxnnb6uj20zm07ogmg.jpg" style="zoom:33%;" />

如何计算：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xy2gvhpj20x2058jro.jpg" style="zoom:33%;" />

如果阶数更高，如何计算？

## 全排列

​       n个不同元素所有不同排列方式总数：Pn=n∙(n-1)∙∙∙2∙1=**n!**

## 逆序数

​       对于一个排列，标准顺序规定为从小到大，**大数在小数前面就称为逆序**。一个排列中逆序的数目称为逆序数，用τ表示：τ(53214)=4+2+1=7

## n阶行列式解法

- 教科书式解法：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27y4qclhij2120060dga.jpg" style="zoom:33%;" />

- 实际上：
  - 将矩阵转化为**上（下）三角形矩阵**
  - 将高阶行列式拆分成**二阶/三阶行列式**

## 克拉默法则

### 定义

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yespz49j20t807wt9d.jpg" style="zoom:33%;" />

​       当系数行列式不等于0时，其解唯一，且：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yfene85j206s03ydfo.jpg" style="zoom:33%;" />

​       其中 |Ai| 就是把 |A| 中第i列元素换成常数向量，而其余各列保持不变得到的。

### 性质

- 当**系数行列式不等于0**时，方程组有**唯一解**

- 对于**齐次**线性方程组：
  - 其**有非零解**的充要条件为其**系数行列式为0**
  - 其**仅有零解**的充要条件为其**系数行列式不为0**

- 当方程组中方程的个数与未知量的个数不同时，抑或系数行列式为0时，克拉默法则失效

# 矩阵

## 定义   

​       对线性方程组的抽象→矩阵

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xpbpf8nj20wq0go0u0.jpg" style="zoom:33%;" />         <img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xsc46suj20ra0bu0ti.jpg" style="zoom: 33%;" />

​       线性方程组：**Ax=b**，其中，

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27xuobyxzj20t408adgh.jpg" style="zoom:33%;" />

A: 系数矩阵，x: 未知量向量， b: 常数向量

## 计算

- 矩阵的加减法——对应位置元素做运算：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27ylw7iqjj20y20c8gmv.jpg" style="zoom:33%;" />

- 矩阵的标量乘法——每一个元素均乘以该常数：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27ymmhqm0j20jy03uwem.jpg" style="zoom: 50%;" />

- **矩阵的向量乘法——第一个矩阵的列数和第二个矩阵的行数相等：**

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yncrnpnj213u044mxv.jpg" style="zoom:50%;" />

## 性质

### 矩阵的秩

- 行秩：线性无关的行的最大数目

- 列秩：线性无关的列的最大数目

- 行秩 = 列秩

### 线性相关

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27zak2su6j20wi07umxj.jpg" style="zoom:33%;" />

- **线性相关**：α_1, …,α_n不全为0

- 不失一般性，假设α1不为0，则上式可变形为：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27zbk21ilj20h603m0sq.jpg" style="zoom: 50%;" />

所以，线性相关性的**核心**是**一个向量可由其它向量组合得来**

- **线性无关**：α_1, …,α_n全为0

所以，线性无关性的**核心**是**一个向量不可由其它向量组合得来**

### 矩阵的转置

- 对于矩阵A，其转置定义为A^T，有：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27zjlyuofj215s08a0tk.jpg" style="zoom: 33%;" />

- 本质：**行列互换**

- 性质：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27zkt5ok7j209g04kdft.jpg" style="zoom: 50%;" />

### 矩阵的逆

- 定义

​       对于方阵（行数等于列数）A，若存在一个矩阵B，使得：**AB=BA=E**（E为单位矩阵），则称B是A的逆矩阵，记为A^(-1)，A被称为可逆矩阵；A和B互为逆矩阵。

- **矩阵可逆的充要条件**是：它是**满秩**的

- **逆矩阵的唯一性**：**若矩阵A是可逆的，则A的逆矩阵是唯一的**
- 性质：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27zoz00l9j20b004gaa1.jpg" style="zoom: 50%;" />

# 神经网络中的矩阵/向量

## 基本概念

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yrkvtooj20oa0diabf.jpg" style="zoom:33%;" />

- 输入层：输入的数据（图像，文本）
- 隐藏层：神经网络处理过程
- 输出层：输出神经网络判别结果
- 数据载体：矩阵/向量
- 运算方式：矩阵乘法（+激活函数）（**激活函数：做一些非线性的处理**）

​       经过神经网络的处理，最终输出层两个节点表示各个分类所对应的的概率值。

## 举例：二分类

输入：<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yyxgg28j205i058mx0.jpg" style="zoom: 25%;" />

隐藏层权重矩阵：<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yzfmau7j20as03o3ye.jpg" style="zoom:25%;" />

隐藏层偏置矩阵：<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yzor9e1j205g03c0sj.jpg" style="zoom:25%;" />

输出层：softmax函数：<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27yzx9kyxj20mg040mx7.jpg" style="zoom: 25%;" />

- 前向传播

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27z3ituwvj20pk05674h.jpg" style="zoom: 50%;" />

- Softmax处理

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h27z45r1tvj20hg07ajrp.jpg" style="zoom: 50%;" />

∴ 该输入为第二种标签的可能接近于100%，判定为第二类

# 线性空间

## 定义

​       设V是一个非空集合，P是一个域，若：

1、在V中定义一种运算——加法，使得V中任意两个元素α与β都依据某一法则对应于V内唯一确定的一个元素α+β，称为α与β的和；

2、在P与V的元素间定义了一种运算，称为数量乘法，即对V中任意元素α与P中任意元素k，都按某一法则对应V内唯一确定的一个元素kα, 称为k与α的积；

3、若上述加法与数量乘法满足以下条件：

​       (1) α+β=β+α, ∀α,β∈V;   

​       (2) α+(β+γ)=(α+β)+γ, ∀α,β,γ∈V；

​       (3)∃零元0∈V, s.t. ∀α∈V, 有α+0=α; 

​       (4) ∀α∈V, ∃β使α+β=0, 记β=-α；

​       (5) 对P中单位元1, ∀α∈V,有1α=α;   

​       (6) ∀k,l∈P, ∀α∈V,有(kl)α=k(lα)；

​       (7)∀k,l∈P, ∀α∈V,有(k+l)α=kα+lα; 

​       (8)∀k∈P, ∀α,β∈V,有k(α+β)=kα+kβ

则称V为域P上的一个线性空间，或向量空间

## 线性变换

### 定义

​       线性空间V上的一个变换A称为线性变换，若对于V中任意元素α,β和数域P中任意k，都有：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2807ws5l4j20io04gweo.jpg" style="zoom:50%;" />

### 实质

​       符合上述定义的每一个方阵都代表着一种线性变换

- **零变换是线性变换**

### 几何意义

- 旋转

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h280b3hduwj21em0lsq5m.jpg" style="zoom:33%;" />

- 拉伸

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h280b9qeezj21ew0lwtbc.jpg" style="zoom:33%;" />

# 特征值与特征向量

## 定义

​       对于n阶方阵A, 若有数λ以及非零n维向量x使得：Ax=λx，则称数λ为矩阵A的一个**特征值**，x为矩阵A关于λ的一个**特征向量**。

## 几何意义

​       在方阵A的变换作用下，特征向量x沿着其所在方向伸缩了λ倍。

## 特征多项式

​       设A为n阶方阵，

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h280e9mjb7j20o00263yi.jpg" style="zoom: 50%;" />

后者为一关于n各未知量以及n个方程的齐次线性方程组

回忆：对于其次线性方程组，其有非零解的充要条件是系数行列式为0：

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h280f0ipzqj20f4024zk5.jpg" style="zoom:50%;" />

称|A-λI|为A的**特征多项式**：

- 通过求解(2)式得到A的特征值
- 将求得的特征值代入(1)式中求得对应的特征向量

# NumPy中的矩阵操作

## 模块与包

模块：以.py结尾的Python源代码文件

- NumPy
- sys
- time
- ......

包：模块的集合

## NumPy的导入

```py
import numpy as np    # 导入NumPy模块
```

```py
print(np.version.version)   # 查看当前安装的NumPy的版本
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280n3xp9mj21n004k3yk.jpg)

## NumPy的基本数据结构

```py
a = np.array([[1, 2, 3], [4, 5, 6]])   # NumPy中基本数据类型-数组的声明
print(a)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280mstkzaj21ms05i74e.jpg)

```py
print("数组a的维度个数为: ", a.ndim)  # 数组的维度
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280nywravj21me04o3yn.jpg)

```py
print("数组a的各个维度长度为: ", a.shape)  # 数组各个维度的长度
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280p08u2fj21me04c3yo.jpg)

```py
print("数组a中元素总数为: ", a.size)  # 数组里元素总数
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280pqs4qgj21mk04m0sv.jpg)

```py
print("数组a中元素类型为: ", a.dtype)  # 数组元素的类型
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280qjuqyaj21mg04qdg0.jpg)

```py
b = np.arange(0, 20, 5)     # 用arange函数创建数组 (开始值，终值，步长)
print(b)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280rbesnbj21mm04kjrg.jpg)

```py
b.reshape(2, 2)         # 改变数组的形状
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280s59cgkj21mi060jrl.jpg)

```py
c = np.linspace(0, 2, 10)   # 用linspace函数创建数组（开始值，终值，元素个数）
print(c)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280t466efj21mm05oq3i.jpg)

```py
zero_arr = np.zeros((3,4))   # 快速创建元素全为0的数组
print(zero_arr)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280tto8w9j21mc06e0sx.jpg)

```py
one_arr = np.ones((2,3,4), dtype=np.int64)   # 快速创建元素全为1的数组，并将类型设置为整型
print(one_arr)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280unmq9fj21ms0acaaf.jpg)

```py
eye_arr = np.eye(3)   # 快速创建对角阵 
print(eye_arr)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280v92zt1j21mi06ijrk.jpg)

## NumPy数组的切片和索引

```py
arr = np.array([1, 2, 3, 4, 5, 6])
print(arr[0:4])      
print(arr[0:4:2])
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280w3fo81j21mi05eglp.jpg)

```py
for ele in arr:     # 对数组中每个元素的遍历
    print(ele)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280wzn3jzj21mi09e74g.jpg)

```py
arr = arr.reshape(2,3)     # 更改arr数组的形状
print(arr)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280xlpaemj21mi05oglq.jpg)

```py
print(arr[0,:])            # 在arr数组里选择第一维度的第一个子序列
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280yetsw6j21mg04m0ss.jpg)

```py
print(arr[0, 0])           # 在arr数组里选择第一维度的第一个子序列里的第一个元素
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280z1w59rj21mg04mmx7.jpg)

```py
print(arr[:, 1])           # 在arr数组里选择第二维度的第二个子序列里的所有元素
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h280zqs65dj21mm04mt8r.jpg)

## NumPy数组的基本操作

```py
arr1 = np.array([[1, 2], [3, 4]])     # 声明两个二维数组
print(arr1)
print("********")
arr2 = np.array([[5, 6], [7, 8]])
print(arr2)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2810jfo9pj21mk08gt8z.jpg)

```py
print(arr2-arr1)     # 两个数组元素级别的差运算
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2811ac5jvj21mm05gq31.jpg)

```py
print(arr2+arr1)     # 两个数组元素级别的和运算
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2811w01qaj21mk05k74e.jpg)

```py
print(arr2*arr1)     # 两个数组元素级别的乘运算
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2812e2unij21mk05iglq.jpg)

```py
print(arr2/arr1)     # 两个数组元素级别的除运算
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2812yltdyj21mg05ijrj.jpg)

```py
print(arr1**2)     # 数组元素级别的乘方运算 
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2813hlso7j21mi05gglq.jpg)

```py
print(arr1@arr2)     # 两个数组之间的矩阵乘积运算
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h28144bn15j21mc05iglq.jpg)

```py
print(np.dot(arr1, arr2))   # 使用dot进行的两个数组之间的矩阵乘积运算
print("*" * 10)
print(arr1.dot(arr2))
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2814w6khrj21mi08eq39.jpg)

```py
print(arr1.T)      # 数组的转置
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2815etkkgj21mk05g74d.jpg)

```py
arr3 = np.array([[1, 2, 3], [4, 5, 6]])
print(arr3)
print("arr1中最大元素的索引为: ", np.argmax(arr3))                    # 数组中值最大元素的索引
print("arr1中沿第一个轴最大元素的索引为: ", np.argmax(arr3, axis=0))    # 数组中沿第一个维度值最大元素的索引
print("arr1中沿第二个轴最大元素的索引为: ", np.argmax(arr3, axis=1))    # 数组中沿第二个维度值最大元素的索引
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h281675oyoj21me08adgi.jpg)

## NumPy求解线性方程组

```py
# NumPy中array与matrix的异同
import numpy as np
a_arr = np.array([1,2])
print("Array形式的a形状为：", a_arr.shape)
a_mat = np.mat([1,2])
print("Matrix形式的a形状为：", a_mat.shape)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2817svdl7j21mg05k74l.jpg)

```py
# 得到矩阵的转置
mat_temp = np.mat([[1,2],[3,4]])
print("此矩阵为：\n", mat_temp)
print('*' * 10)
print("此矩阵的转置为：\n", mat_temp.T)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2818s0j90j21mk0a8wex.jpg)

```py
# 得到矩阵的逆
mat_temp = np.mat([[1,2],[3,4]])
print("此矩阵为：\n", mat_temp)
print('*' * 10)
mat_inv = mat_temp.I
print("此矩阵的逆矩阵为：\n", mat_inv)
print("此矩阵与它的逆矩阵相乘得到：\n", np.round(mat_temp.dot(mat_inv)))    # np.round用来保留结果到指定位数
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h2819kpg4uj21mg0d0t9h.jpg)

```py
import numpy as np
equa = np.mat([[1,2,3],[4,5,6]])
print("此线性方程组为：\n", equa)
print('*' * 10)
A = np.array([[1,2], [4,5]])   # 2x2系数矩阵
b = np.array([3,6])            # 2x1矩阵(须为列向量的形式)
res = np.linalg.solve(A,b)     # 求解该系数矩阵决定的线性方程组
print("此线性方程组的解为：\n", res.reshape(1,2).T)
```

![](https://tva1.sinaimg.cn/large/e6c9d24ely1h281ac6sdtj21me0acq3h.jpg)

