<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>十点云音乐 | 小新's Blog</title><meta name="keywords" content="实战"><meta name="author" content="小新,1096463510@qq.com"><meta name="copyright" content="小新"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="基础知识什么是小程序 2017 年度百度百科十大热词之一 微信小程序，简称小程序，英文名 Mini Program，是一种不需要下载安装即可使用的应用（张小龙对其的定义是无需安装，用完即走，实际上是需要安装的，只不过小程序的体积特别小，下载速度很快，用户感觉不到下载的过程） 小程序刚发布的时候要求压缩包的体积不能大于1M,，否则无法通过，在2017年4月做了改进，由原来的1M提升到 2M 2017">
<meta property="og:type" content="article">
<meta property="og:title" content="十点云音乐">
<meta property="og:url" content="https://liuwqtech.github.io/2022/11/28/%E5%AE%9E%E6%88%98/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%88%98/%E5%8D%81%E7%82%B9%E4%BA%91%E9%9F%B3%E4%B9%90/index.html">
<meta property="og:site_name" content="小新&#39;s Blog">
<meta property="og:description" content="基础知识什么是小程序 2017 年度百度百科十大热词之一 微信小程序，简称小程序，英文名 Mini Program，是一种不需要下载安装即可使用的应用（张小龙对其的定义是无需安装，用完即走，实际上是需要安装的，只不过小程序的体积特别小，下载速度很快，用户感觉不到下载的过程） 小程序刚发布的时候要求压缩包的体积不能大于1M,，否则无法通过，在2017年4月做了改进，由原来的1M提升到 2M 2017">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://qn.liuwqtech.top/008vxvgGly1h8l4rdwqmzj30gk0g6aa2.jpg">
<meta property="article:published_time" content="2022-11-28T12:48:46.000Z">
<meta property="article:modified_time" content="2023-03-21T06:03:26.720Z">
<meta property="article:author" content="小新">
<meta property="article:tag" content="实战">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://qn.liuwqtech.top/008vxvgGly1h8l4rdwqmzj30gk0g6aa2.jpg"><link rel="shortcut icon" href="http://qn.liuwqtech.top/008i3skNgy1gpw51zrippj305k05k74p.jpg"><link rel="canonical" href="https://liuwqtech.github.io/2022/11/28/%E5%AE%9E%E6%88%98/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%88%98/%E5%8D%81%E7%82%B9%E4%BA%91%E9%9F%B3%E4%B9%90/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 小新","link":"链接: ","source":"来源: 小新's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-center"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-21 14:03:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="http://qn.liuwqtech.top/008i3skNgy1gpw4suzt6aj30u00u077g.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">79</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">32</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('http://qn.liuwqtech.top/008vxvgGly1h8l4rdwqmzj30gk0g6aa2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">小新's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">十点云音乐</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-28T12:48:46.000Z" title="发表于 2022-11-28 20:48:46">2022-11-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-21T06:03:26.720Z" title="更新于 2023-03-21 14:03:26">2023-03-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E6%88%98/">实战</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E6%88%98/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%88%98/">小程序实战</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">13.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>65分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="十点云音乐"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="什么是小程序"><a href="#什么是小程序" class="headerlink" title="什么是小程序"></a>什么是小程序</h2><ol>
<li>2017 年度百度百科十大热词之一</li>
<li>微信小程序，简称小程序，英文名 Mini Program，是一种不需要下载安装即可使用的应用（张小龙对其的定义是无需安装，用完即走，实际上是需要安装的，只不过<strong>小程序的体积特别小</strong>，下载速度很快，用户感觉不到下载的过程）</li>
<li>小程序刚发布的时候要求压缩包的体积不能大于1M,，否则无法通过，在2017年4月做了改进，由原来的1M提升到 2M</li>
<li><strong>2017年1月9日0点，万众瞩目的微信第一批小程序正式低调上线。</strong></li>
</ol>
<h2 id="小程序的优点"><a href="#小程序的优点" class="headerlink" title="小程序的优点"></a>小程序的优点</h2><ol>
<li><strong>同 App 进行互补</strong>，提供同 app 类型的功能，比 app 使用方便简洁</li>
<li>通过扫一扫或者在微信搜索即可下载</li>
<li><strong>用户使用频率不高，但又不得不用的功能软件</strong>，目前看来小程序是首选</li>
<li>连接线上线下</li>
<li>开发门槛低， 成本低</li>
</ol>
<h2 id="小程序开发"><a href="#小程序开发" class="headerlink" title="小程序开发"></a>小程序开发</h2><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><ol>
<li>官网：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">https://mp.weixin.qq.com/</a></li>
<li>微信开发工具</li>
<li>下载地址：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html?t=2018315">https://mp.weixin.qq.com/debug/wxadoc/dev/devtools/download.html?t=2018315</a></li>
</ol>
<h3 id="注册小程序账号"><a href="#注册小程序账号" class="headerlink" title="注册小程序账号"></a>注册小程序账号</h3><p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/getstart.html#%E7%94%B3%E8%AF%B7%E5%B8%90%E5%8F%B7">https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/getstart.html#%E7%94%B3%E8%AF%B7%E5%B8%90%E5%8F%B7</a></p>
<h2 id="开发小程序储备知识"><a href="#开发小程序储备知识" class="headerlink" title="开发小程序储备知识"></a>开发小程序储备知识</h2><h3 id="Flex布局"><a href="#Flex布局" class="headerlink" title="Flex布局"></a>Flex布局</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><ol>
<li>Flex 是 Flexible Box 的缩写，意为“弹性布局”，用来为盒状模型提供最大的灵活性</li>
<li>任何一个容器都可以指定为 Flex 布局</li>
<li>display: ‘flex’</li>
</ol>
<img src="http://qn.liuwqtech.top/008vxvgGly1h89hk5rs7rj31460ne0uq.jpg" style="zoom: 33%;" />

<h4 id="flex属性"><a href="#flex属性" class="headerlink" title="flex属性"></a>flex属性</h4><ul>
<li>flex-direction：<ul>
<li>row（默认值）：主轴为水平方向，起点在左端</li>
<li>row-reverse：主轴为水平方向，起点在右端</li>
<li>column：主轴为垂直方向，起点在上沿</li>
<li>column-reverse：主轴为垂直方向，起点在下沿</li>
</ul>
</li>
</ul>
<h4 id="学习地址"><a href="#学习地址" class="headerlink" title="学习地址"></a>学习地址</h4><p><a target="_blank" rel="noopener" href="http://www.runoob.com/w3cnote/flex-grammar.html">http://www.runoob.com/w3cnote/flex-grammar.html</a></p>
<h3 id="移动端相关知识"><a href="#移动端相关知识" class="headerlink" title="移动端相关知识"></a>移动端相关知识</h3><h4 id="物理像素"><a href="#物理像素" class="headerlink" title="物理像素"></a>物理像素</h4><ol>
<li>屏幕的分辨率</li>
<li>设备能控制显示的最小单元，可以把物理像素看成是对应的像素点</li>
</ol>
<h4 id="设备独立像素-amp-css像素"><a href="#设备独立像素-amp-css像素" class="headerlink" title="设备独立像素 &amp; css像素"></a>设备独立像素 &amp; css像素</h4><p>设备独立像素（也叫密度无关像素），可以认为是计算机坐标系统中的一个点，这个点代表一个<strong>可以由程序使用并控制的虚拟像素</strong>（比如：CSS 像素，只是在 android 机中 CSS 像素就不叫“CSS像素”了，而是叫“设备独立像素”），然后由相关系统转换为物理像素。</p>
<h4 id="dpr比-amp-DPI-amp-PPI"><a href="#dpr比-amp-DPI-amp-PPI" class="headerlink" title="dpr比 &amp; DPI &amp; PPI"></a>dpr比 &amp; DPI &amp; PPI</h4><ol>
<li><strong>dpr</strong>：设备像素比，物理像素/设备独立像素 = dpr， 一般以 iphon6 的 dpr 为准 dpr = 2</li>
<li>PPI：一英寸显示屏上的像素点个数</li>
<li>DPI：最早指的是打印机在单位面积上打印的墨点数，墨点越多越清晰</li>
</ol>
<h3 id="移动端适配方案"><a href="#移动端适配方案" class="headerlink" title="移动端适配方案"></a>移动端适配方案</h3><h4 id="viewport适配"><a href="#viewport适配" class="headerlink" title="viewport适配"></a>viewport适配</h4><ol>
<li><p>为什么做 viewport 适配</p>
<p>a)  手机厂商在生产手机的时候大部分手机默认页面宽度为 980px</p>
<p>b)  手机实际视口宽度都要小于 980px，如: iphone6 为 375px</p>
<p>c)  开发需求: 需要将 980 的页面完全显示在手机屏幕上且没有滚动条</p>
</li>
<li><p>实现：</p>
</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="rem适配"><a href="#rem适配" class="headerlink" title="rem适配"></a>rem适配</h4><ol>
<li><p>为什么做 rem 适配</p>
<p>a)  机型太多，不同的机型屏幕大小不一样</p>
<p>b)  需求: 一套设计稿的内容在不同的机型上呈现的效果一致，根据屏幕大小不同的变化，页面中的内容也相应变化</p>
</li>
<li><p>实现：</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">remRefresh</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">let</span> clientWidth = <span class="built_in">document</span>.documentElement.clientWidth;</span><br><span class="line">		<span class="comment">// 将屏幕等分 10 份</span></span><br><span class="line">		<span class="keyword">let</span> rem = clientWidth / <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">document</span>.documentElement.style.fontSize = rem + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">    <span class="built_in">document</span>.body.style.fontSize = <span class="string">&#x27;12px&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;pageshow&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		remRefresh()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 函数防抖</span></span><br><span class="line"><span class="keyword">let</span> timeoutId;</span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    timeoutId &amp;&amp; <span class="built_in">clearTimeout</span>(timeoutId);</span><br><span class="line">    timeoutId = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span>&#123;</span><br><span class="line">    remRefresh()</span><br><span class="line">    &#125;, <span class="number">300</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>第三方库实现：lib-flexible + px2rem-loader</li>
</ol>
<h2 id="小程序特点"><a href="#小程序特点" class="headerlink" title="小程序特点"></a>小程序特点</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ol>
<li><p><strong>没有 DOM</strong></p>
</li>
<li><p><strong>组件化开发</strong>：具备特定功能效果的代码集合</p>
</li>
<li><p>体积小，单个压缩包体积不能大于 2M，否则无法上线</p>
</li>
<li><p>小程序的<strong>四个重要的文件</strong></p>
<p>a)  *.js</p>
<p>b)  *.wxml —&gt; view 结构 —-&gt; html</p>
<p>c)  *.wxss —&gt; view 样式 —–&gt; css</p>
<p>d)  *. json —-&gt; view 数据 —–&gt; json 文件</p>
</li>
<li><p><strong>小程序适配方案：rpx（responsive pixel 响应式像素单位）</strong></p>
<p>a)  小程序适配单位: rpx</p>
<p>b)  规定任何屏幕下宽度为 750rpx</p>
<p>c)  小程序会根据屏幕的宽度不同自动计算 rpx 值的大小</p>
<p>d)  Iphone6 下：1rpx = 1 物理像素 = 0.5px</p>
<img src="http://qn.liuwqtech.top/008vxvgGly1h89i637scoj313a0d60tx.jpg" style="zoom:50%;" /></li>
</ol>
<h3 id="小程序配置"><a href="#小程序配置" class="headerlink" title="小程序配置"></a>小程序配置</h3><h4 id="全局配置-app-json"><a href="#全局配置-app-json" class="headerlink" title="全局配置: app.json"></a>全局配置: app.json</h4><p><strong>作用</strong>：用于为整个应用进行选项设置</p>
<p><strong>链接</strong>：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html</a></p>
<img src="http://qn.liuwqtech.top/008vxvgGly1h89jfonjglj314w0kognt.jpg" style="zoom: 33%;" />

<h4 id="页面配置：页面名称-json"><a href="#页面配置：页面名称-json" class="headerlink" title="页面配置：页面名称.json"></a>页面配置：页面名称.json</h4><p><strong>作用</strong>：用于为指定的页面进行配置</p>
<p><strong>链接</strong>：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html</a></p>
<p><strong>注意！页面配置的优先级高于全局配置</strong></p>
<img src="http://qn.liuwqtech.top/008vxvgGly1h89jhqllf8j314w0jego8.jpg" style="zoom:33%;" />

<h4 id="sitemap配置-sitemap-json"><a href="#sitemap配置-sitemap-json" class="headerlink" title="sitemap配置: sitemap.json"></a>sitemap配置: sitemap.json</h4><p>作用：用于被微信搜索爬取页面</p>
<p>链接：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html</a></p>
<img src="http://qn.liuwqtech.top/008vxvgGly1h89jjc7a0yj314w0iiwhl.jpg" style="zoom:33%;" />

<h3 id="小程序框架接口"><a href="#小程序框架接口" class="headerlink" title="小程序框架接口"></a>小程序框架接口</h3><h4 id="App"><a href="#App" class="headerlink" title="App"></a>App</h4><ol>
<li>全局 app.js 中执行<code>App()</code></li>
<li>生成当前应用的实例对象</li>
<li><code>getApp()</code>获取全局应用实例</li>
</ol>
<h4 id="Page"><a href="#Page" class="headerlink" title="Page"></a>Page</h4><ol>
<li>页面.js 中执行<code>Page()</code></li>
<li>生成当前页面的实例</li>
<li>通过<code>getCurrentPages</code>获取页面实例</li>
</ol>
<h2 id="wxml语法"><a href="#wxml语法" class="headerlink" title="wxml语法"></a>wxml语法</h2><h3 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h3><h4 id="初始化数据"><a href="#初始化数据" class="headerlink" title="初始化数据"></a>初始化数据</h4><p>页面.js 的 data 选项中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    msg: <span class="string">&#x27;初始化测试数据&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="使用数据"><a href="#使用数据" class="headerlink" title="使用数据"></a>使用数据</h4><ol>
<li>模板结构中使用双大括号 <code>&#123;&#123;msg&#125;&#125;</code></li>
<li>注意事项: 小程序中为单项数据流 model —&gt; view</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;userName&quot;</span>&gt;</span> &#123;&#123;msg&#125;&#125; <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><ol>
<li><p><code>this.setData(&#123;message: ‘修改之后的数据’&#125;, callback)</code></p>
</li>
<li><p>特点:</p>
<p>a)  同步修改: this.data 值被同步修改</p>
<p>b)  异步更新: 异步将 setData 函数用于将数据从逻辑层发送到视图层(异步)</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">onLoad</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">   <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">       msg: <span class="string">&#x27;小新&#x27;</span></span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ol>
<li><p><strong>小程序</strong></p>
<ol>
<li>data中初始化数据</li>
<li>修改数据： <code>this.setData()</code><ul>
<li>修改数据的行为始终是同步的</li>
</ul>
</li>
<li>数据流： <ul>
<li>单向： Model —&gt; View</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>Vue</strong></p>
<ol>
<li><p>data中初始化数据</p>
</li>
<li><p>修改数据: <code>this.key = value</code></p>
</li>
<li><p>数据流： </p>
<ul>
<li><p>Vue是单向数据流： Model —&gt; View</p>
</li>
<li><p>Vue中实现了<strong>双向数据绑定</strong>： v-model</p>
</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>React</strong></p>
<ol>
<li><p>state中初始化状态数据</p>
</li>
<li><p>修改数据: <code>this.setState()</code></p>
<ul>
<li><p>自身钩子函数中(componentDidMount)异步的</p>
</li>
<li><p>非自身的钩子函数中(定时器的回调)同步的</p>
</li>
</ul>
</li>
<li><p>数据流： </p>
<ul>
<li>单向： Model —&gt; View</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h3><h4 id="事件分类"><a href="#事件分类" class="headerlink" title="事件分类"></a>事件分类</h4><ol>
<li><p><strong>冒泡事件</strong></p>
<ul>
<li>定义：当一个组件上的事件被触发后，<strong>该事件会向父节点传递</strong>。</li>
<li>冒泡事件列表: <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/event.html">https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/event.html</a></li>
</ul>
</li>
<li><p><strong>非冒泡事件</strong></p>
<ul>
<li>定义：当一个组件上的事件被触发后，<strong>该事件不会向父节点传递</strong>。</li>
<li>非冒泡事件：<strong>表单事件和自定义事件通常是非冒泡事件</strong> <a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/event.html">https://mp.weixin.qq.com/debug/wxadoc/dev/framework/view/wxml/event.html</a></li>
</ul>
</li>
</ol>
<h4 id="绑定事件"><a href="#绑定事件" class="headerlink" title="绑定事件"></a>绑定事件</h4><ol>
<li><strong>bind绑定</strong>：事件绑定不会阻止冒泡事件向上冒泡（绑定冒泡事件）</li>
<li><strong>catch绑定</strong>：事件绑定可以阻止冒泡事件向上冒泡（绑定非冒泡事件）</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goStudy&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;handleParent&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">text</span> <span class="attr">catchtap</span>=<span class="string">&quot;handleChild&quot;</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="事件流的三个阶段"><a href="#事件流的三个阶段" class="headerlink" title="事件流的三个阶段"></a>事件流的三个阶段</h4><ol>
<li>捕获: 从外向内</li>
<li>执行目标阶段</li>
<li>冒泡: 从内向外</li>
</ol>
<h4 id="向事件对象传参"><a href="#向事件对象传参" class="headerlink" title="向事件对象传参"></a>向事件对象传参</h4><ul>
<li>语法：<code>data-key = value</code></li>
</ul>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8kn2ed1mtj317404agmr.jpg" style="zoom:50%;" />

<ul>
<li>获取：<code>event.target.dataset.key || event.currentTarget.dataset.key</code></li>
<li><code>event.target</code> 和 <code>event.currentTarget</code> 的区别<ul>
<li><code>event.target</code> 是触发事件的对象，但不一样是绑定事件的对象，如: 事件委托，冒泡</li>
<li><code>currentTarget</code> 触发时间的对象一定是绑定事件的对象， 没有事件委托</li>
</ul>
</li>
</ul>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><h4 id="对应阶段说明"><a href="#对应阶段说明" class="headerlink" title="对应阶段说明"></a>对应阶段说明</h4><ol>
<li><strong>onLoad(Object query)</strong></li>
</ol>
<ul>
<li>页面加载时触发。一个页面<strong>只会调用一次</strong>，<strong>可以在 onLoad 的参数中获取打开当前页面路径中的参数</strong>。</li>
<li>参数：</li>
</ul>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">类型</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">query</td>
<td align="center">Object</td>
<td align="center">打开当前页面路径中的参数</td>
</tr>
</tbody></table>
<ol start="2">
<li> <strong>onShow()</strong></li>
</ol>
<ul>
<li>页面显示/切入前台时触发</li>
<li>会执行多次</li>
</ul>
<ol start="3">
<li><strong>onReady()</strong></li>
</ol>
<ul>
<li>页面初次渲染完成时触发。一个页面<strong>只会调用一次</strong>，代表页面已经准备妥当， 可以和视图层进行交互。</li>
</ul>
<ol start="4">
<li><strong>onHide()</strong></li>
</ol>
<ul>
<li>页面隐藏/切入后台时触发。 如 wx.navigateTo 或底部 tab 切换到其他页面，小程序切入后台等。</li>
</ul>
<ol start="5">
<li><strong>onUnload()</strong></li>
</ol>
<ul>
<li>页面卸载时触发。如 wx.redirectTo 或 wx.navigateBack 到其他页面时。  </li>
</ul>
<h4 id="官网图示说明"><a href="#官网图示说明" class="headerlink" title="官网图示说明"></a>官网图示说明</h4><img src="http://qn.liuwqtech.top/008vxvgGly1h8ai5xaiuej30ie0s6jt6.jpg" style="zoom:67%;" />

<h4 id="官网对应地址"><a href="#官网对应地址" class="headerlink" title="官网对应地址"></a>官网对应地址</h4><p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page-life-cycle.html">https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page-life-cycle.html</a></p>
<h3 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h3><h4 id="语法说明"><a href="#语法说明" class="headerlink" title="语法说明"></a>语法说明</h4><ul>
<li><code>wx:for=&#39;&#123;&#123;arr&#125;&#125;&#39;</code></li>
<li><code>wx:key=&#39;&#123;&#123;唯一值&#125;&#125;&#39;</code></li>
</ul>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li>默认的个体：item</li>
<li>默认的下标：index</li>
<li>自定义个体变量名称：<code>wx:for-item=&#39;myItem&#39;</code></li>
<li>自定义下标变量名称：<code>wx:for-index=&#39;myIndex&#39;</code></li>
</ul>
<h3 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h3><h4 id="语法说明-1"><a href="#语法说明-1" class="headerlink" title="语法说明"></a>语法说明</h4><ul>
<li><code>wx:if = &#39;条件&#39;</code></li>
<li><code>wx:elif = &#39;条件&#39;</code></li>
<li><code>wx:else</code></li>
</ul>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8bcig48mhj30x40jewg7.jpg" style="zoom: 50%;" />

<h4 id="wx-if-VS-hidden"><a href="#wx-if-VS-hidden" class="headerlink" title="wx:if VS hidden"></a>wx:if VS hidden</h4><ul>
<li>hidden 用法：<code>&lt;view hidden=&#39;&#123;&#123;true&#125;&#125;&#39;&gt;&lt;/view&gt;</code></li>
<li>wx:if 等同于 v-if，条件为 false 的时候不加载，条件切换的时候决定元素销毁或者重新加载渲染</li>
<li>hidden 等同于 v-show，始终加载元素，条件切换的时候决定元素的显示和隐藏</li>
</ul>
<h3 id="模版使用"><a href="#模版使用" class="headerlink" title="模版使用"></a>模版使用</h3><h4 id="定义模板"><a href="#定义模板" class="headerlink" title="定义模板"></a>定义模板</h4><img src="http://qn.liuwqtech.top/008vxvgGly1h8kn7zc6d6j314q0lmabh.jpg" style="zoom: 33%;" />

<h4 id="引入模版"><a href="#引入模版" class="headerlink" title="引入模版"></a>引入模版</h4><ol>
<li>引入模板结构: <code>&lt;import src=&#39;模板结构相对路径&#39;/&gt;</code></li>
<li>引入模板样式: <code>@Import &#39;模板样式路径&#39;</code></li>
</ol>
<h4 id="使用模板"><a href="#使用模板" class="headerlink" title="使用模板"></a>使用模板</h4><img src="http://qn.liuwqtech.top/008vxvgGly1h8knfibg6nj314e0oawfx.jpg" style="zoom:33%;" />

<h2 id="小程序API"><a href="#小程序API" class="headerlink" title="小程序API"></a>小程序API</h2><h3 id="API使用说明"><a href="#API使用说明" class="headerlink" title="API使用说明"></a>API使用说明</h3><ol>
<li>小程序提供了很多实用的方法供开发者使用</li>
<li>小程序全局对象是: wx</li>
<li>所有的 API 都保存在 wx 对象中</li>
</ol>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8knj5kjwnj31ai0lgtb4.jpg" style="zoom: 33%;" />

<h3 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h3><ol>
<li><p><strong>界面交互</strong></p>
<ul>
<li>显示消息提示框: <code>wx.showToast()</code></li>
<li>显示消息加载框: <code>wx.showLoading()</code></li>
<li>关闭消息提示框: <code>wx.hideToast()</code></li>
<li>关闭消息加载框: <code>wx.hideLoading()</code></li>
</ul>
</li>
<li><p><strong>路由跳转</strong></p>
<ul>
<li><code>wx.navigateTo()</code></li>
<li><code>wx.redirectTo()</code></li>
<li><code>wx.switchTab()</code></li>
</ul>
</li>
<li><p><strong>网络请求</strong></p>
<ul>
<li><code>wx.request()</code></li>
</ul>
</li>
<li><p><strong>本地存储</strong></p>
<ul>
<li><code>wx.setStorage()</code></li>
<li><code>wx.setStorageSync()</code></li>
<li><code>wx.getStorage()</code></li>
<li><code>wx.getStorageSync()</code></li>
</ul>
</li>
<li><p><strong>媒体</strong></p>
<ul>
<li><code>wx.getBackgroundAudioManager()</code></li>
<li><code>wx.playVoice()</code></li>
</ul>
</li>
</ol>
<h2 id="前后端交互"><a href="#前后端交互" class="headerlink" title="前后端交互"></a>前后端交互</h2><ol>
<li><p>语法: <code>wx.request()</code></p>
</li>
<li><p>注意点: </p>
<ul>
<li><p><strong>协议必须是https协议</strong></p>
</li>
<li><p>一个接口最多配置20个域名</p>
</li>
<li><p>并发限制上限是10个</p>
</li>
<li><p><strong>开发过程中设置不校验合法域名</strong>： 开发工具 —&gt; 右上角详情 —-&gt; 本地设置 —&gt; 不校验</p>
</li>
</ul>
</li>
</ol>
<h2 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h2><ol>
<li>什么是事件委托<ul>
<li>将子元素的事件委托(绑定)给父元素</li>
</ul>
</li>
<li><strong>事件委托的好处</strong><ul>
<li><strong>减少绑定的次数</strong></li>
<li><strong>后期新添加的元素也可以享用之前委托的事件</strong></li>
</ul>
</li>
<li>事件委托的原理<ul>
<li>冒泡</li>
</ul>
</li>
<li>触发事件的是谁<ul>
<li>子元素</li>
</ul>
</li>
<li>如何找到触发事件的对象<ul>
<li>event.target</li>
</ul>
</li>
<li>currentTarget VS target<ul>
<li>currentTarget要求绑定事件的元素一定是触发事件的元素</li>
<li>target绑定事件的元素不一定是触发事件的元素</li>
</ul>
</li>
</ol>
<h2 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h2><h3 id="存入数据"><a href="#存入数据" class="headerlink" title="存入数据"></a>存入数据</h3><ol>
<li><p>语法: <code>wx.setStorage() || wx.setStorageSync() || .....</code></p>
</li>
<li><p>注意点： </p>
<ul>
<li><p><strong>建议存储的数据为json数据</strong></p>
</li>
<li><p>单个 key 允许存储的最大数据长度为 1MB，所有数据存储上限为 10MB</p>
</li>
<li><p>属于<strong>永久存储</strong>，同H5的localStorage一样</p>
</li>
</ul>
</li>
</ol>
<h3 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h3><ul>
<li><code>wx.getStorage()</code>异步</li>
<li><code>wx.getStorageSync()</code>同步</li>
</ul>
<h3 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h3><ul>
<li><code>wx.removeStorage()</code>异步</li>
<li><code>wx.removeStroageSync()</code>同步</li>
</ul>
<h3 id="清空数据"><a href="#清空数据" class="headerlink" title="清空数据"></a>清空数据</h3><ul>
<li><code>wx.clearStorage()</code>异步</li>
<li><code>wx.clearStorageSync()</code>同步</li>
</ul>
<h2 id="定义事件相关"><a href="#定义事件相关" class="headerlink" title="定义事件相关"></a>定义事件相关</h2><ol>
<li><p>分类</p>
<ul>
<li>标准DOM事件</li>
<li>自定义事件</li>
</ul>
</li>
<li><p>标准DOM事件</p>
<ul>
<li>举例： click，input。。。</li>
<li>事件名固定的，事件由浏览器触发</li>
</ul>
</li>
<li><p>自定义事件</p>
<ul>
<li><p>绑定事件</p>
<ul>
<li>事件名</li>
<li>事件的回调</li>
<li>订阅方: PubSub.subscribe(事件名，事件的回调)</li>
<li><strong>订阅方是接受数据的一方</strong></li>
</ul>
</li>
<li><p>触发事件</p>
<ul>
<li>事件名</li>
<li>提供事件参数对象， 等同于原生事件的event对象</li>
<li>发布方: PubSub.publish(事件名，提供的数据)</li>
<li><strong>发布方是提供数据的一方</strong></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="页面通信"><a href="#页面通信" class="headerlink" title="页面通信"></a>页面通信</h2><h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><ol>
<li>传参方式<ul>
<li>路由地址中 + query 传参数</li>
<li>示例: url?a=123</li>
</ul>
</li>
<li>获取参数：跳转目标页面的 onLoad 函数中的 options 实参中获取</li>
</ol>
<h3 id="消息订阅发布"><a href="#消息订阅发布" class="headerlink" title="消息订阅发布"></a>消息订阅发布</h3><ol>
<li>使用第三方库: <code>pubsub-js</code></li>
<li>安装：<code>npm install pubsub-js</code></li>
<li>使用:<ul>
<li><code>import PubSub from ‘pubsub-js’</code></li>
<li>订阅消息: <code>PubSub.subscribe(&#39;eventName&#39;, callback)</code></li>
<li>发布消息: <code>PubSub.publish(&#39;eventName&#39;, data)</code></li>
<li>取消订阅: <code>PubSub.unsubscribe(&#39;eventName&#39;)</code></li>
</ul>
</li>
</ol>
<h3 id="eventChannel事件通道"><a href="#eventChannel事件通道" class="headerlink" title="eventChannel事件通道"></a>eventChannel事件通道</h3><ol>
<li>订阅事件：<code>wx.navigateTo()</code>跳转的时候在 events 选项中定义事件名及事件对应的回调</li>
</ol>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8knyhslr8j311o0ikmz8.jpg" style="zoom: 33%;" />

<ol start="2">
<li>获取事件总线对象<ul>
<li>目标页面中通过：<code>实例.getOpenerEventChannel()</code></li>
<li>示例: <code>const eventChannel = this.getOpenerEventChannel()</code> </li>
</ul>
</li>
<li>触发事件：<code>eventChannel.emit(&#39;事件名&#39;, data)</code></li>
</ol>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8ko09zlynj311q0g0mzd.jpg" style="zoom: 33%;" />

<h2 id="自定义组件"><a href="#自定义组件" class="headerlink" title="自定义组件"></a>自定义组件</h2><h3 id="创建组件"><a href="#创建组件" class="headerlink" title="创建组件"></a>创建组件</h3><ol>
<li>开发工具中右键新建组件</li>
<li>组件对应的 json 文件中设置: <code>component: true</code></li>
</ol>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8ko1wtpqpj30s408kdg8.jpg" style="zoom: 33%;" />

<h3 id="使用组件"><a href="#使用组件" class="headerlink" title="使用组件"></a>使用组件</h3><p>使用组件的页面的 json 文件中注册使用组件</p>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8ko2n9nabj311s0foq47.jpg" style="zoom:33%;" />

<h2 id="使用npm包"><a href="#使用npm包" class="headerlink" title="使用npm包"></a>使用npm包</h2><ol>
<li>初始化 package.json：<code>npm init</code></li>
<li>勾选允许使用npm</li>
<li>下载npm包：<code>npm install packageName</code></li>
<li>构建npm<ul>
<li>开发工具 —&gt; 工具 —&gt; 构建 npm</li>
<li>会将 node_modules 中的包打包到 miniprogram_npm 中</li>
</ul>
</li>
</ol>
<h2 id="获取用户唯一标识-openId"><a href="#获取用户唯一标识-openId" class="headerlink" title="获取用户唯一标识(openId)"></a>获取用户唯一标识(<strong>openId</strong>)</h2><h3 id="官网图解"><a href="#官网图解" class="headerlink" title="官网图解"></a>官网图解</h3><img src="http://qn.liuwqtech.top/008vxvgGly1h8kwoffl8vj30jq0k075f.jpg" style="zoom: 67%;" />

<h3 id="获取流程"><a href="#获取流程" class="headerlink" title="获取流程"></a>获取流程</h3><ol>
<li><code>wx.login()</code>，拿到code</li>
<li>发送 code 给服务器端</li>
<li>服务器端发送请求携带参数(code, appSecret, appId)给微信服务器获取 openId<ul>
<li>接口地址：<a target="_blank" rel="noopener" href="https://api.weixin.qq.com/sns/jscode2session?appid=APPID&amp;secret=SECRET&amp;js_code=JSCODE&amp;grant_type=authorization_code">https://api.weixin.qq.com/sns/jscode2session?appid=APPID&amp;secret=SECRET&amp;js_code=JSCODE&amp;grant_type=authorization_code</a></li>
<li>请求方法: GET</li>
</ul>
</li>
<li>appSecret，appId 在小程序首页获取</li>
<li>服务器获取 openId 后<strong>进行加密</strong>返回给前端</li>
</ol>
<h2 id="小程序分包"><a href="#小程序分包" class="headerlink" title="小程序分包"></a>小程序分包</h2><h3 id="为什么要分包"><a href="#为什么要分包" class="headerlink" title="为什么要分包"></a>为什么要分包</h3><ol>
<li>小程序要求压缩包体积不能大于 2M，否则无法发布</li>
<li>实际开发中小程序体积如果大于 2M 就需要使用分包机制进行发布上传</li>
<li><strong>分包后可解决 2M 限制，并且能分包加载内容，提高性能</strong></li>
<li>分包后单个包的体积不能大于 2M</li>
<li>分包后所有包的体积不能大于 16M</li>
</ol>
<h3 id="分包形式"><a href="#分包形式" class="headerlink" title="分包形式"></a>分包形式</h3><ol>
<li>常规分包</li>
<li>独立分包</li>
<li>分包预下载</li>
</ol>
<h3 id="常规分包"><a href="#常规分包" class="headerlink" title="常规分包"></a>常规分包</h3><ol>
<li>开发者通过在 app.json 中，用 subpackages 字段声明项目分包结构</li>
<li>特点：<ul>
<li><strong>加载小程序的时候先加载主包，当需要访问分包的页面时候才加载分包内容</strong></li>
<li>分包的页面可以访问主包的文件，数据，图片等资源</li>
<li>主包:<ul>
<li>主包来源: 除了分包以外的内容都会被打包到主包中</li>
<li>通常放置启动页 /tabBar 页面</li>
</ul>
</li>
</ul>
</li>
</ol>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8ky7qk5fdj311g0degmp.jpg" style="zoom:50%;" />

<img src="http://qn.liuwqtech.top/008vxvgGly1h8kzlcbplyj31es0u0jvr.jpg" style="zoom: 33%;" />

<h3 id="独立分包"><a href="#独立分包" class="headerlink" title="独立分包"></a>独立分包</h3><ol>
<li><strong>设置 independent 为 true</strong> </li>
<li>特点：<ul>
<li><strong>独立分包可单独访问分包的内容，不需要下载主包</strong></li>
<li><strong>独立分包不能依赖主包或者其他包的内容</strong> </li>
</ul>
</li>
<li>使用场景<ul>
<li>通常某些页面和当前小程序的其他页面关联不大的时候可进行独立分包</li>
<li>如：临时加的广告页 || 活动页</li>
</ul>
</li>
</ol>
<h3 id="分包预下载"><a href="#分包预下载" class="headerlink" title="分包预下载"></a>分包预下载</h3><ol>
<li><p>配置</p>
<ul>
<li>app.json 中设置 preloadRule 选项</li>
<li>key(页面路径): {packages: [预下载的包名 || 预下载的包的根路径])}</li>
</ul>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8kzxvi4jcj313s0k2wfw.jpg" style="zoom:33%;" /></li>
<li><p>特点</p>
<ul>
<li><strong>在加载当前包的时候可以设置预下载其他的包</strong></li>
<li><strong>缩短用户等待时间，提高用户体验</strong></li>
</ul>
</li>
</ol>
<h3 id="官网对应地址-1"><a href="#官网对应地址-1" class="headerlink" title="官网对应地址"></a>官网对应地址</h3><p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages.html">https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages.html</a></p>
<h2 id="小程序转发分享"><a href="#小程序转发分享" class="headerlink" title="小程序转发分享"></a>小程序转发分享</h2><h3 id="分享实现"><a href="#分享实现" class="headerlink" title="分享实现"></a>分享实现</h3><ol>
<li>Button 组件设置 open-type 为 share</li>
<li><code>&lt;button open-type=&#39;share&#39;&gt;&lt;/button&gt;</code></li>
</ol>
<h3 id="自定义分享内容"><a href="#自定义分享内容" class="headerlink" title="自定义分享内容"></a>自定义分享内容</h3><p>生命周期回调中 onShareAppMessage 回调中 return 对象设置自定义内容</p>
<img src="http://qn.liuwqtech.top/008vxvgGly1h8l02dqjk0j30xi0h6gml.jpg" style="zoom: 33%;" />

<h2 id="小程序支付流程"><a href="#小程序支付流程" class="headerlink" title="小程序支付流程"></a>小程序支付流程</h2><h3 id="支付流程官网图解"><a href="#支付流程官网图解" class="headerlink" title="支付流程官网图解"></a>支付流程官网图解</h3><img src="http://qn.liuwqtech.top/008vxvgGly1h8l035rh2ej31020u0tbe.jpg" style="zoom:50%;" />

<h3 id="详细说明"><a href="#详细说明" class="headerlink" title="详细说明"></a>详细说明</h3><ol>
<li><p>用户在小程序客服端下单(包含用户及商品信息)</p>
</li>
<li><p>小程序客户端发送下单支付请求给商家服务器</p>
</li>
<li><p>商家服务器同微信服务器对接获取唯一标识 openID</p>
</li>
<li><p>商家服务器根据 openId 生成商户订单(包含商户信息)</p>
</li>
<li><p>商家服务器发送请求调用统一下单 API 获取预支付订单信息</p>
<ul>
<li>接口地址：<a target="_blank" rel="noopener" href="https://api.mch.weixin.qq.com/pay/unifiedorder">https://api.mch.weixin.qq.com/pay/unifiedorder</a> </li>
</ul>
</li>
<li><p>商家对预支付信息签名加密后返回给小程序客户端</p>
<ul>
<li>签名方式：MD5</li>
<li>签名字段：小程序 ID，时间戳，随机串，数据包，签名方式</li>
<li>参考地址：<a target="_blank" rel="noopener" href="https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=7_7&amp;index=3">https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=7_7&amp;index=3</a></li>
</ul>
</li>
<li><p>用户确认支付(鉴权调起支付)</p>
<ul>
<li>API: <code>wx.requestPayment()</code></li>
</ul>
</li>
<li><p>微信服务器返回支付结果给小程序客户端 </p>
</li>
<li><p>微信服务器推送支付结果给商家服务器端</p>
</li>
</ol>
<h3 id="官网对应地址-2"><a href="#官网对应地址-2" class="headerlink" title="官网对应地址"></a>官网对应地址</h3><p><a target="_blank" rel="noopener" href="https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=7_3&amp;index=1">https://pay.weixin.qq.com/wiki/doc/api/wxa/wxa_api.php?chapter=7_3&amp;index=1</a></p>
<h1 id="实战：TenCloudMusic"><a href="#实战：TenCloudMusic" class="headerlink" title="实战：TenCloudMusic"></a>实战：TenCloudMusic</h1><h2 id="主页"><a href="#主页" class="headerlink" title="主页"></a>主页</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l4xtj8lnj30ho0vm41s.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;indexContainer&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 轮播图 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">&quot;banners&quot;</span> <span class="attr">indicator-dots</span>=<span class="string">&quot;true&quot;</span> <span class="attr">indicator-color</span>=<span class="string">&quot;ivory&quot;</span> <span class="attr">indicator-active-color</span>=<span class="string">&quot;#d43c33&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;bannerList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;bannerId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.pic&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 五个图标导航区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navContainer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navItem&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;toRecommendSong&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-meirituijian&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>每日推荐<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navItem&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-gedan1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>歌单<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navItem&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-icon-ranking&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>排行榜<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navItem&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-diantai&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>电台<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navItem&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-zhiboguankanliangbofangsheyingshexiangjixianxing&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>直播<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 推荐歌曲区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;recommendContainer&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 头部区 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">NavHeader</span> <span class="attr">title</span>=<span class="string">&quot;推荐歌曲&quot;</span> <span class="attr">nav</span>=<span class="string">&quot;为你精心推荐&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">NavHeader</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内容区 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;recommendScroll&quot;</span> <span class="attr">enable-flex</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scroll-x</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;scrollItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;recommendList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.picUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 排行榜 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;topList&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 头部区 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">NavHeader</span> <span class="attr">title</span>=<span class="string">&quot;排行榜&quot;</span> <span class="attr">nav</span>=<span class="string">&quot;热歌风向标&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">NavHeader</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内容区 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">&quot;topListSwiper&quot;</span> <span class="attr">next-margin</span>=<span class="string">&quot;50rpx&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;topList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;swiperItem&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;musicItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;item.tracks&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;musicItem&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;musicItem.al.picUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span>&#123;&#123;index + 1&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;musicName&quot;</span>&gt;</span>&#123;&#123;musicItem.name&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.banners</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.banners</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navContainer</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navItem</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navItem</span> <span class="selector-class">.iconfont</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">240</span>, <span class="number">19</span>, <span class="number">19</span>);</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navItem</span> text &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendContainer</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendContainer</span> <span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendContainer</span> <span class="selector-class">.header</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendContainer</span> <span class="selector-class">.header</span> <span class="selector-class">.more</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10</span>rpx <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendScroll</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollItem</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200</span>rpx;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollItem</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollItem</span> text &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="comment">/* 单行文本溢出隐藏 省略号代替*/</span></span><br><span class="line">    <span class="comment">/* display: block;</span></span><br><span class="line"><span class="comment">    white-space: nowrap;</span></span><br><span class="line"><span class="comment">    overflow: hidden;</span></span><br><span class="line"><span class="comment">    text-overflow: ellipsis; */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 多行文本溢出隐藏 省略号代替*/</span></span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    -webkit-box-orient: vertical; <span class="comment">/* 设置对齐模式*/</span></span><br><span class="line">    -webkit-line-clamp: <span class="number">2</span>; <span class="comment">/* 设置多行的行数*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.topList</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.topListSwiper</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">400</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.swiperItem</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">96%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fbfbfb</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.swiperItem</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicItem</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicItem</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicItem</span> <span class="selector-class">.count</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicItem</span> <span class="selector-class">.musicName</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">400</span>rpx;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;../../utils/request&quot;</span></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        bannerList:[],</span><br><span class="line">        recommendList:[],</span><br><span class="line">        topList:[]</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    onLoad: <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> bannerResult = <span class="keyword">await</span> request(<span class="string">&#x27;/banner&#x27;</span>,&#123;<span class="attr">type</span>:<span class="number">2</span>&#125;,<span class="string">&#x27;GET&#x27;</span>); </span><br><span class="line">        <span class="keyword">let</span> recommendResult = <span class="keyword">await</span> request(<span class="string">&#x27;/personalized&#x27;</span>,&#123;<span class="attr">limit</span>:<span class="number">30</span>&#125;,<span class="string">&#x27;GET&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            bannerList: bannerResult.banners,</span><br><span class="line">            recommendList: recommendResult.result,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> topDetail = <span class="keyword">await</span> request(<span class="string">&#x27;/toplist&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>);</span><br><span class="line">        <span class="keyword">let</span> resultArray = [];</span><br><span class="line">        <span class="keyword">while</span> (index &lt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> topId = topDetail.list[index].id</span><br><span class="line">            <span class="keyword">let</span> topListResult = <span class="keyword">await</span> request(<span class="string">&#x27;/top/list&#x27;</span>,&#123;<span class="attr">id</span>:topId&#125;,<span class="string">&#x27;GET&#x27;</span>);</span><br><span class="line">            <span class="keyword">let</span> topListItem = &#123;</span><br><span class="line">                name: topListResult.playlist.name,</span><br><span class="line">                tracks: topListResult.playlist.tracks.slice(<span class="number">0</span>,<span class="number">3</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            resultArray.push(topListItem);</span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                topList: resultArray</span><br><span class="line">            &#125;)</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//跳转至每日推荐歌曲页面</span></span><br><span class="line">    <span class="function"><span class="title">toRecommendSong</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        wx.navigateTo(&#123;</span><br><span class="line">            url:<span class="string">&#x27;/songPackage/pages/recommendSong/recommendSong&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;usingComponents&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;NavHeader&quot;</span>: <span class="string">&quot;/components/NavHeader/NavHeader&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;nav&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;more&quot;</span>&gt;</span>查看更多<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> <span class="selector-class">.more</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10</span>rpx <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Component(&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 组件的属性列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    properties: &#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">            type: <span class="built_in">String</span>,</span><br><span class="line">            value: <span class="string">&#x27;我是title的默认值&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        nav: &#123;</span><br><span class="line">            type: <span class="built_in">String</span>,</span><br><span class="line">            value: <span class="string">&#x27;我是nav的默认值&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;component&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;usingComponents&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l4ybqqffj30ho0vkaaz.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;left-top-sign&quot;</span>&gt;</span>L O G I N<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;welcome&quot;</span>&gt;</span></span><br><span class="line">    欢迎回来!</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;input-content&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;input-item&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;tit&quot;</span>&gt;</span>手机号码<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入手机号码&quot;</span> <span class="attr">id</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;handleInput&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;input-item&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;tit&quot;</span>&gt;</span>密码<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span> <span class="attr">id</span>=<span class="string">&quot;password&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;handleInput&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;confirm-btn&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;login&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;forget-section&quot;</span>&gt;</span></span><br><span class="line">      忘记密码?</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;register-section&quot;</span>&gt;</span></span><br><span class="line">    还没有账号?</span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> &gt;</span>马上注册<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrapper</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">90</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">40</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left-top-sign</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">120</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f8f8f8</span>;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">16</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.welcome</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">90</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">46</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.input-content</span>&#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">60</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.input-item</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>:flex-start;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>:<span class="number">#f8f6fc</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">120</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">50</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.input-item</span><span class="selector-pseudo">:last-child</span>&#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.input-item</span> <span class="selector-class">.tit</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">56</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">34</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#424446</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.input-item</span> <span class="selector-tag">input</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#95989e</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.confirm-btn</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">630</span>rpx<span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">76</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">76</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">70</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#d43c33</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.confirm-btn2</span>:after&#123;</span><br><span class="line">    border-radius: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.forget-section</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#4399fc</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">40</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.register-section</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#606266</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.register-section</span> text&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#4399fc</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;../../utils/request&quot;</span>;</span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        phone:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        password:<span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">handleInput</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> type = event.currentTarget.id;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            [type]:event.detail.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//登录</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> &#123;phone, password&#125; = <span class="built_in">this</span>.data;</span><br><span class="line">        <span class="keyword">if</span>(!phone)&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;手机号不能为空&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//定义正则表达式</span></span><br><span class="line">        <span class="keyword">let</span> phoneReg = <span class="regexp">/^1(3|4|5|6|7|8|9)\d&#123;9&#125;$/</span>;</span><br><span class="line">        <span class="keyword">if</span>(!phoneReg.test(phone))&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;手机号格式错误&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!password)&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;密码不能为空&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> loginResult = <span class="keyword">await</span> request(<span class="string">&#x27;/login/cellphone&#x27;</span>,&#123;phone,password,<span class="attr">isLogin</span>:<span class="literal">true</span>&#125;,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(loginResult.code === <span class="number">200</span>)&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;登录成功&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;success&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//将用户的信息存储至本地</span></span><br><span class="line">            wx.setStorageSync(<span class="string">&#x27;userInfo&#x27;</span>,<span class="built_in">JSON</span>.stringify(loginResult.profile))</span><br><span class="line">            <span class="comment">//跳转至个人中心页</span></span><br><span class="line">            wx.reLaunch(&#123;</span><br><span class="line">                url:<span class="string">&#x27;/pages/personal/personal&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (loginResult.code === <span class="number">400</span>)&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;手机号错误&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (loginResult.code === <span class="number">502</span>)&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;密码错误&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">                title:<span class="string">&#x27;登录失败&#x27;</span>,</span><br><span class="line">                icon:<span class="string">&#x27;error&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;usingComponents&quot;</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;登录中心&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="个人中心"><a href="#个人中心" class="headerlink" title="个人中心"></a>个人中心</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l4ysdi2zj30hq0vmacm.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;personalContainer&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user-section&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;bg&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://qn.liuwqtech.top/008vxvgGly1h8l0cu5ik5j31930u077v.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user-info-box&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;toLogin&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;portrait-box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;portrait&quot;</span> <span class="attr">src</span>=<span class="string">&#x27;&#123;&#123;userInfo.avatarUrl?userInfo.avatarUrl:&quot;/static/images/personal/missing-face.png&quot;&#125;&#125;&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;info-box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;username&quot;</span>&gt;</span>&#123;&#123;userInfo.nickname?userInfo.nickname:&#x27;游客&#x27;&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;vip-card-box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;card-bg&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/personal/vip-card-bg.png&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;b-btn&quot;</span>&gt;</span></span><br><span class="line">        立即开通</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tit&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 会员图标--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-huiyuan-&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        十点云音乐会员</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- &lt;text class=&quot;e-m&quot;&gt;SDCloudMusic Union&lt;/text&gt; --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- &lt;text class=&quot;e-b&quot;&gt;开通黑胶会员, 静享极致体验&lt;/text&gt; --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;e-b&quot;</span>&gt;</span>开通黑胶会员, 静享极致体验<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;cover-container&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">bindtouchstart</span>=<span class="string">&quot;handleTouchStart&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">bindtouchmove</span>=<span class="string">&quot;handleTouchMove&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">bindtouchend</span>=<span class="string">&quot;handleTouchEnd&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;transform: &#123;&#123;coverTransform&#125;&#125;; transition: &#123;&#123;coverTransition&#125;&#125;;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;arc&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/personal/arc.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 个人中心导航 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;nav-section&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>  <span class="attr">hover-class</span>=<span class="string">&quot;common-hover&quot;</span>  <span class="attr">hover-stay-time</span>=<span class="string">&quot;50&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-xiaoxi&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>我的消息<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>   <span class="attr">hover-class</span>=<span class="string">&quot;common-hover&quot;</span> <span class="attr">hover-stay-time</span>=<span class="string">&quot;50&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-myRecommender&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>我的好友<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span>  <span class="attr">hover-class</span>=<span class="string">&quot;common-hover&quot;</span>  <span class="attr">hover-stay-time</span>=<span class="string">&quot;50&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-gerenzhuye&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>个人主页<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;nav-item&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;common-hover&quot;</span>  <span class="attr">hover-stay-time</span>=<span class="string">&quot;50&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-gexingzhuangban&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>个性装扮<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 个人中心列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;personalContent&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;recentPlayContainer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>最近播放<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 最近播放记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;recentPlayList.length&#125;&#125;&quot;</span> <span class="attr">scroll-x</span> <span class="attr">class</span>=<span class="string">&quot;recentScroll&quot;</span> <span class="attr">enable-flex</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;recentItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;recentPlayList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.song.al.picUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:else</span> <span class="attr">class</span>=<span class="string">&quot;recentPlayText&quot;</span>&gt;</span>暂无播放记录<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cardList&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;card-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>我的音乐<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;more&quot;</span>&gt;</span> &gt; <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;card-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>我的收藏<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;more&quot;</span>&gt;</span> &gt; <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;card-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>我的电台<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;more&quot;</span>&gt;</span> &gt; <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.personalContainer</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.personalContainer</span> <span class="selector-class">.user-section</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">520</span>rpx;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">100</span>rpx <span class="number">30</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.user-section</span> <span class="selector-class">.bg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0.7</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">1px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.user-info-box</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">180</span>rpx;</span><br><span class="line">    <span class="attribute">display</span>:flex;</span><br><span class="line">    <span class="attribute">align-items</span>:center;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="selector-class">.user-info-box</span> <span class="selector-class">.portrait</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">130</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">130</span>rpx;</span><br><span class="line">    <span class="attribute">border</span>:<span class="number">5</span>rpx solid <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.user-info-box</span> <span class="selector-class">.username</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#303133</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">/* vip-box */</span></span><br><span class="line"><span class="selector-class">.vip-card-box</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="comment">/* background: linear-gradient(left, red, black); */</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">7</span>);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">240</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7d680</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">16</span>rpx <span class="number">16</span>rpx <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">24</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vip-card-box</span> <span class="selector-class">.card-bg</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">380</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">260</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vip-card-box</span> <span class="selector-class">.b-btn</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">16</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">132</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">22</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#36343c</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f9e6af</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-class">.vip-card-box</span> <span class="selector-class">.b-btn</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">16</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">132</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">22</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#36343c</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="comment">/*background: linear-gradient(left, #f9e6af, #ffd465);*/</span> <span class="comment">/*渐变不生效*/</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f9e6af</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-class">.vip-card-box</span> <span class="selector-class">.tit</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">22</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f7d680</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">28</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.vip-card-box</span> <span class="selector-class">.tit</span> <span class="selector-class">.iconfont</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f6e5a3</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">16</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.vip-card-box</span> <span class="selector-class">.e-m</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">34</span>rpx;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.vip-card-box</span> <span class="selector-class">.e-b</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#d8cba9</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.cover-container</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">150</span>rpx;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">    <span class="attribute">padding-bottom</span>: <span class="number">20</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.cover-container</span> <span class="selector-class">.arc</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">34</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">36</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 导航部分 */</span></span><br><span class="line">  <span class="selector-class">.cover-container</span> <span class="selector-class">.nav-section</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">15</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.nav-section</span> <span class="selector-class">.nav-item</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">25%</span>;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.nav-section</span> <span class="selector-class">.nav-item</span> <span class="selector-class">.iconfont</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#d43c33</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">70</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.nav-section</span> <span class="selector-class">.nav-item</span> text<span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">22</span>rpx;</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 个人中心列表 */</span></span><br><span class="line">  <span class="selector-class">.personalContent</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* 最近播放 */</span></span><br><span class="line">  <span class="selector-class">.personalContent</span> <span class="selector-class">.scrollView</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">160</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.personalContent</span> <span class="selector-class">.recentPlay</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-class">.recentPlayContainer</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.personalContent</span> <span class="selector-class">.recentPlay</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">160</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">160</span>rpx;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.cardList</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20</span>rpx;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-class">.cardList</span> <span class="selector-class">.card-item</span>&#123;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.cardList</span> <span class="selector-class">.card-item</span> <span class="selector-class">.more</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 最近播放记录 */</span></span><br><span class="line"><span class="selector-class">.recentScroll</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recentItem</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recentScroll</span> image&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recentPlayText</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;../../utils/request&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> startY = <span class="number">0</span>; <span class="comment">//手指起始的坐标</span></span><br><span class="line"><span class="keyword">let</span> moveY = <span class="number">0</span>; <span class="comment">//手指移动的坐标</span></span><br><span class="line"><span class="keyword">let</span> moveDistance = <span class="number">0</span>; <span class="comment">//手指移动的距离</span></span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        coverTransform: <span class="string">&#x27;translateY(0)&#x27;</span>,</span><br><span class="line">        coverTransition: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        userInfo:&#123;</span><br><span class="line">            userId:<span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;, <span class="comment">//用户信息</span></span><br><span class="line">        recentPlayList:[] <span class="comment">//用户播放记录</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    onLoad: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//读取用户基本信息</span></span><br><span class="line">        <span class="keyword">let</span> userInfo = wx.getStorageSync(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(userInfo)&#123;</span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                userInfo: <span class="built_in">JSON</span>.parse(userInfo)</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//获取用户的播放记录</span></span><br><span class="line">            <span class="built_in">this</span>.getUserRecentPlayList(<span class="built_in">this</span>.data.userInfo.userId)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">   <span class="keyword">async</span> <span class="function"><span class="title">getUserRecentPlayList</span>(<span class="params">userId</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> recentPlayListData = <span class="keyword">await</span> request(<span class="string">&#x27;/user/record&#x27;</span>,&#123;<span class="attr">uid</span>: userId,<span class="attr">type</span>:<span class="number">0</span>&#125;,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">let</span> recentPlayList = recentPlayListData.allData.splice(<span class="number">0</span>,<span class="number">10</span>).map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">            item.id = index++</span><br><span class="line">            <span class="keyword">return</span> item</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            recentPlayList</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">handleTouchStart</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            coverTransition: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        startY = event.touches[<span class="number">0</span>].clientY;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">handleTouchMove</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        moveY = event.touches[<span class="number">0</span>].clientY;</span><br><span class="line">        moveDistance = moveY - startY;</span><br><span class="line">        <span class="keyword">if</span>(moveDistance &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(moveDistance &gt;= <span class="number">80</span>)&#123;</span><br><span class="line">            moveDistance = <span class="number">80</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//动态更新coverTransform的状态值</span></span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            coverTransform: <span class="string">`translateY(<span class="subst">$&#123;moveDistance&#125;</span>rpx)`</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">handleTouchEnd</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            coverTransform: <span class="string">&#x27;translateY(0)&#x27;</span>,</span><br><span class="line">            coverTransition: <span class="string">&#x27;transform 0.5s linear&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//跳转至login登陆页面的回调</span></span><br><span class="line">    <span class="function"><span class="title">toLogin</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        wx.navigateTo(&#123;</span><br><span class="line">            url:<span class="string">&#x27;/pages/login/login&#x27;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l4z90ddzj30hq0vmmyr.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;searchContainer&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 头部搜索区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;searchInput&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-search1 searchIcon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123;searchContent&#125;&#125;&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;&#123;&#123;placeholderContent&#125;&#125;&quot;</span> <span class="attr">placeholder-class</span>=<span class="string">&quot;placeholder&quot;</span> <span class="attr">bindinput</span>=<span class="string">&quot;handleInput&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;clear&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;clearSearchContent&quot;</span> <span class="attr">hidden</span>=<span class="string">&quot;&#123;&#123;!searchContent&#125;&#125;&quot;</span>&gt;</span>X<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;cancle&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;searchList.length&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 搜索内容展示区域 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;showSearchContent&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;searchContent&quot;</span>&gt;</span>搜索内容：&#123;&#123;searchContent&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;searchList&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;searchItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;searchList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-search1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:else</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 搜索历史记录 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;history&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;historyList.length&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>历史<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;historyItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;historyList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;&#123;&#123;item&#125;&#125;&quot;</span>&gt;</span>&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 删除 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-shanchu delete&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;deleteSearchHistory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 热搜榜 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;hotContainer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>热搜榜<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 热搜列表 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;hotList&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;hotItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;hotList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;searchWord&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;order&quot;</span>&gt;</span>&#123;&#123;index + 1&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;item.searchWord&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;iconImage&quot;</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.iconUrl&#125;&#125;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.iconUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.searchContainer</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 头部搜索区域 */</span></span><br><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.searchInput</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">237</span>, <span class="number">237</span>, <span class="number">237</span>, <span class="number">0.3</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.searchIcon</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">15</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.searchInput</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.placeholder</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#d43c33</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clear</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.cancle</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 热搜榜 */</span></span><br><span class="line"><span class="selector-class">.hotContainer</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.hotContainer</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.hotList</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.hotItem</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.hotItem</span> <span class="selector-class">.order</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.iconImage</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">35</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 搜索内容展示区域 */</span></span><br><span class="line"><span class="selector-class">.searchContent</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#d43c33</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#d43c33</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.searchItem</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.searchItem</span> <span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 搜索历史记录 */</span></span><br><span class="line"><span class="selector-class">.history</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.history</span> <span class="selector-class">.title</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.historyItem</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ededed</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.history</span> <span class="selector-class">.delete</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">10</span>rpx;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">15</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;../../utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//用于函数节流</span></span><br><span class="line"><span class="keyword">let</span> isSend = <span class="literal">false</span></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        placeholderContent:<span class="string">&#x27;&#x27;</span>, <span class="comment">//默认搜索内容</span></span><br><span class="line">        hotList:[], <span class="comment">//热搜榜数据</span></span><br><span class="line">        searchContent:<span class="string">&#x27;&#x27;</span>, <span class="comment">//用户输入的标单项的数据</span></span><br><span class="line">        searchList:<span class="string">&#x27;&#x27;</span>, <span class="comment">//关键字模糊匹配的数据</span></span><br><span class="line">        historyList: [], <span class="comment">//搜索历史记录</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 获取初始化数据</span></span><br><span class="line">        <span class="built_in">this</span>.getInitData()</span><br><span class="line">        <span class="comment">// 获取本地搜索历史记录</span></span><br><span class="line">        <span class="built_in">this</span>.getSearchHistory() </span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取本地历史搜索记录的函数</span></span><br><span class="line">    <span class="function"><span class="title">getSearchHistory</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> historyList = wx.getStorageSync(<span class="string">&#x27;searchHistory&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(historyList)&#123;</span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                historyList</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取初始化数据</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getInitData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> placeholderData = <span class="keyword">await</span> request(<span class="string">&#x27;/search/default&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="keyword">let</span> hotListData = <span class="keyword">await</span> request(<span class="string">&#x27;/search/hot/detail&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            placeholderContent: placeholderData.data.showKeyword,</span><br><span class="line">            hotList: hotListData.data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//标单项发生改变后的回调</span></span><br><span class="line">   <span class="function"><span class="title">handleInput</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            searchContent: event.detail.value.trim()</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span>(isSend)&#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        isSend = <span class="literal">true</span></span><br><span class="line">        <span class="built_in">this</span>.getSearchList()</span><br><span class="line">        <span class="comment">// 函数节流</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">async</span>() =&gt; &#123;</span><br><span class="line">            isSend = <span class="literal">false</span></span><br><span class="line">        &#125;,<span class="number">300</span>)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取搜索数据的函数</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getSearchList</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">this</span>.data.searchContent)&#123;</span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                searchList: []</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> &#123;searchContent, historyList&#125; = <span class="built_in">this</span>.data</span><br><span class="line">        <span class="comment">//发请求获取关键字模糊匹配数据</span></span><br><span class="line">        <span class="keyword">let</span> searchListData = <span class="keyword">await</span> request(<span class="string">&#x27;/search&#x27;</span>,&#123;<span class="attr">keywords</span>:searchContent, <span class="attr">limit</span>:<span class="number">10</span>&#125;,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            searchList: searchListData.result.songs</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//将搜索的关键字添加到搜索历史记录中</span></span><br><span class="line">        <span class="keyword">if</span>(historyList.indexOf(searchContent) !== -<span class="number">1</span>)&#123;</span><br><span class="line">            historyList.splice(historyList.indexOf(searchContent),<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        historyList.unshift(searchContent)</span><br><span class="line">        wx.setStorageSync(<span class="string">&#x27;searchHistory&#x27;</span>, historyList)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 清空搜索内容</span></span><br><span class="line">    <span class="function"><span class="title">clearSearchContent</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            searchContent: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            searchList: []</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除历史记录</span></span><br><span class="line">    <span class="function"><span class="title">deleteSearchHistory</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        wx.showModal(&#123;</span><br><span class="line">            content: <span class="string">&#x27;确认删除历史记录吗？&#x27;</span>,</span><br><span class="line">            success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(res.confirm)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                        historyList:[]</span><br><span class="line">                    &#125;)</span><br><span class="line">                    wx.removeStorageSync(<span class="string">&#x27;searchHistory&#x27;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;usingComponents&quot;</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;发现音乐&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l4ztkdrkj30hs0vm41a.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;videoContainer&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 头部区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/video/video.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;search&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;toSearch&quot;</span>&gt;</span>搜索音乐<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/logo.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 导航区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scroll-view</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">scroll-x</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;navScroll&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">scroll-into-view</span>=<span class="string">&quot;&#123;&#123;&#x27;scroll&#x27; + navId&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">scroll-with-animation</span></span></span><br><span class="line"><span class="tag">        <span class="attr">enable-flex</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">id</span>=<span class="string">&quot;&#123;&#123;&#x27;scroll&#x27; + item.id&#125;&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;navItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;videoGroupList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navContent &#123;&#123;navId===item.id?&#x27;active&#x27;:&#x27;&#x27;&#125;&#125;&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;changeNav&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&#123;&#123;item.id&#125;&#125;&quot;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 视频列表区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scroll-view</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">scroll-y</span></span></span><br><span class="line"><span class="tag">        <span class="attr">refresher-enabled</span></span></span><br><span class="line"><span class="tag">        <span class="attr">bindrefresherrefresh</span>=<span class="string">&quot;handleRefresh&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">refresher-triggered</span>=<span class="string">&quot;&#123;&#123;isTriggered&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">bindscrolltolower</span>=<span class="string">&quot;handleToLower&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;videoScroll&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;videoItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;videoList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">wx:for-index</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.data.creator.avatarUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;nickName&quot;</span>&gt;</span>&#123;&#123;item.data.creator.nickname&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;comments_praised&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-buoumaotubiao15&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span>&#123;&#123;item.data.praisedCount&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-pinglun1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span>&#123;&#123;item.data.commentCount&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;share&quot;</span> <span class="attr">class</span>=<span class="string">&quot;item btn&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-gengduo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            &lt;video</span><br><span class="line">                class=&quot;common&quot;</span><br><span class="line">                object-fit=&quot;cover&quot;</span><br><span class="line">                src=&quot;&#123;&#123;videoUrl[index]&#125;&#125;&quot;</span><br><span class="line">                poster=&quot;&#123;&#123;item.data.coverUrl&#125;&#125;&quot;</span><br><span class="line">                bindplay=&quot;handlePlay&quot;</span><br><span class="line">                bindtimeupdate=&quot;handleTimeUpdate&quot;</span><br><span class="line">                bindended=&quot;handleEnded&quot;</span><br><span class="line">                id=&quot;&#123;&#123;item.data.vid&#125;&#125;&quot;</span><br><span class="line">                wx:if=&quot;&#123;&#123;videoId === item.data.vid&#125;&#125;&quot;&gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 性能优化：使用image图片代替video标签 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">wx:else</span> <span class="attr">class</span>=<span class="string">&quot;common&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;handlePlay&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&#123;&#123;item.data.vid&#125;&#125;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.data.coverUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;content&quot;</span>&gt;</span>&#123;&#123;item.data.title&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.videoContainer</span> <span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.videoContainer</span> <span class="selector-class">.header</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.videoContainer</span> <span class="selector-class">.header</span> <span class="selector-class">.search</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#d43c33</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 导航区域 */</span></span><br><span class="line"><span class="selector-class">.navScroll</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navScroll</span> <span class="selector-class">.navItem</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navScroll</span> <span class="selector-class">.navContent</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.navItem</span> <span class="selector-class">.active</span> &#123;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#d43c33</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 视频列表 */</span></span><br><span class="line"><span class="selector-class">.videoScroll</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span><br><span class="line">    <span class="comment">/* calc: 可以动态计算css的宽高， 运算符左右两侧必须加空格，否则计算会失效 */</span></span><br><span class="line">    <span class="comment">/* 视口单位： vh vw  1vh = 1%的视口高度  1vw = 1%的视口宽度*/</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100vh</span> - <span class="number">152</span>rpx);</span><br><span class="line">    <span class="comment">/*height: calc(100vh - 100rpx); 用来测试页面上拉触底*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.videoItem</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">3%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.videoItem</span> <span class="selector-class">.common</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">360</span>rpx;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">14</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.videoItem</span> <span class="selector-class">.content</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">500</span>rpx;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">/* footer */</span></span><br><span class="line"><span class="selector-class">.footer</span> &#123;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">24</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> <span class="selector-class">.avatar</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> <span class="selector-class">.nickName</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.footer</span> <span class="selector-class">.comments_praised</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.comments_praised</span> <span class="selector-class">.btn</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: transparent;</span><br><span class="line">    <span class="attribute">border-color</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.comments_praised</span> <span class="selector-class">.btn</span>:after &#123;</span><br><span class="line">    border: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.comments_praised</span> <span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">50</span>rpx;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.comments_praised</span> <span class="selector-class">.item</span> <span class="selector-class">.count</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;../../utils/request&quot;</span></span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        videoGroupList:[], <span class="comment">//导航标签数据</span></span><br><span class="line">        navId: <span class="string">&#x27;&#x27;</span>, <span class="comment">//导航的标识</span></span><br><span class="line">        videoList:[], <span class="comment">//视频列表数据</span></span><br><span class="line">        videoUrl:[], <span class="comment">//视频url</span></span><br><span class="line">        videoId:<span class="string">&#x27;&#x27;</span>, <span class="comment">//视频id标识</span></span><br><span class="line">        videoUpdateTime:[],<span class="comment">//记录video播放的时长</span></span><br><span class="line">        isTriggered: <span class="literal">false</span>, <span class="comment">//标识下拉刷新是否被触发</span></span><br><span class="line">        offset:<span class="number">0</span>,<span class="comment">//分页参数</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">//获取导航数据</span></span><br><span class="line">        <span class="built_in">this</span>.getVideoGroupListData();</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取导航数据</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getVideoGroupListData</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> videoGroupListData = <span class="keyword">await</span> request(<span class="string">&#x27;/video/group/list&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            videoGroupList: videoGroupListData.data.slice(<span class="number">0</span>,<span class="number">14</span>),</span><br><span class="line">            navId: videoGroupListData.data[<span class="number">0</span>].id</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//获取视频列表数据</span></span><br><span class="line">        <span class="built_in">this</span>.getVideoList(<span class="built_in">this</span>.data.navId,<span class="built_in">this</span>.data.offset)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//点击切换导航的回调</span></span><br><span class="line">    <span class="function"><span class="title">changeNav</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> navId = event.currentTarget.id</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            navId: <span class="built_in">Number</span>(navId),</span><br><span class="line">            videoList:[],</span><br><span class="line">            videoUrl:[],</span><br><span class="line">            offset:<span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 显示正在加载</span></span><br><span class="line">        wx.showLoading(&#123;</span><br><span class="line">          title: <span class="string">&#x27;加载中&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 动态获取当前导航的视频数据</span></span><br><span class="line">        <span class="built_in">this</span>.getVideoList(<span class="built_in">this</span>.data.navId,<span class="built_in">this</span>.data.offset)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取视频列表数据</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getVideoList</span>(<span class="params">navId,offset</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!navId)&#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> videoListData = <span class="keyword">await</span> request(<span class="string">&#x27;/video/group&#x27;</span>,&#123;<span class="attr">id</span>:navId,<span class="attr">offset</span>:offset&#125;,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="comment">// 关闭加载提示框</span></span><br><span class="line">        wx.hideLoading()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">let</span> videoList = videoListData.datas.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">            item.id = index++</span><br><span class="line">            <span class="keyword">return</span> item</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            videoList,</span><br><span class="line">            isTriggered: <span class="literal">false</span> <span class="comment">// 关闭下拉刷新</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">let</span> temp = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; videoList.length; i++)&#123;</span><br><span class="line">            temp.push(videoList[i].data.vid)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> videoTemp = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; temp.length; i++)&#123;</span><br><span class="line">            <span class="keyword">let</span> video = <span class="keyword">await</span> request(<span class="string">&#x27;/video/url&#x27;</span>,&#123;<span class="attr">id</span>:temp[i],<span class="attr">t</span>:i&#125;,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">            videoTemp.push(video.urls[<span class="number">0</span>].url)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            videoUrl: videoTemp</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击播放/继续播放的回调</span></span><br><span class="line">    <span class="function"><span class="title">handlePlay</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 问题：多个视频同时播放的问题</span></span><br><span class="line"><span class="comment">         * 需求：</span></span><br><span class="line"><span class="comment">         *  1、在点击播放的事件中需要找到上一个播放的视频</span></span><br><span class="line"><span class="comment">         *  2、在播放新的视频之前关闭上一个正在播放的视频</span></span><br><span class="line"><span class="comment">         * 关键：</span></span><br><span class="line"><span class="comment">         *  1、如何找到上一个视频的实例对象</span></span><br><span class="line"><span class="comment">         *  2、如何确认点击播放的视频和正在播放的视频不是同一个视频</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> vid = event.currentTarget.id</span><br><span class="line">        <span class="comment">// 关闭上一个播放的视频</span></span><br><span class="line">        <span class="comment">// this.vid !== vid &amp;&amp; this.videoContext &amp;&amp; this.videoContext.stop()</span></span><br><span class="line">        <span class="comment">// this.vid = vid</span></span><br><span class="line">        <span class="comment">// 更新data中videoId的状态数据</span></span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            videoId: vid</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 创建创建video标签的实例对象</span></span><br><span class="line">        <span class="built_in">this</span>.videoContext = wx.createVideoContext(vid)</span><br><span class="line">        <span class="comment">// 判断当前的视频是否之前播放过，是否有播放记录，如果有，跳转至指定的播放位置</span></span><br><span class="line">        <span class="keyword">let</span> &#123;videoUpdateTime&#125; = <span class="built_in">this</span>.data</span><br><span class="line">        <span class="keyword">let</span> videoItem = videoUpdateTime.find(<span class="function"><span class="params">item</span> =&gt;</span> item.vid === vid)</span><br><span class="line">        <span class="keyword">if</span>(videoItem)&#123;</span><br><span class="line">            <span class="built_in">this</span>.videoContext.seek(videoItem.currentTime)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.videoContext.play()</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听视频播放进度的回调</span></span><br><span class="line">    <span class="function"><span class="title">handleTimeUpdate</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> videoTimeObj = &#123;</span><br><span class="line">            vid: event.currentTarget.id,</span><br><span class="line">            currentTime: event.detail.currentTime</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> &#123;videoUpdateTime&#125; = <span class="built_in">this</span>.data</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 思路：判断记录播放时长的videoUpdateTime数组中是否有当前视频的播放记录</span></span><br><span class="line"><span class="comment">         *  1、如果有，在原有的播放记录中修改播放时间为当前的播放时间</span></span><br><span class="line"><span class="comment">         *  2、如果没有，需要在数组中添加当前视频的播放对象</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">let</span> videoItem = videoUpdateTime.find(<span class="function"><span class="params">item</span> =&gt;</span> item.vid === videoTimeObj.vid)</span><br><span class="line">        <span class="keyword">if</span>(videoItem)&#123;</span><br><span class="line">            videoItem.currentTime = videoTimeObj.currentTime</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            videoUpdateTime.push(videoTimeObj)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 更新videoUpdateTime的状态</span></span><br><span class="line">        <span class="built_in">this</span>.setData([</span><br><span class="line">            videoUpdateTime</span><br><span class="line">        ])</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 视频播放结束调用的回调</span></span><br><span class="line">    <span class="function"><span class="title">handleEnded</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> &#123;videoUpdateTime&#125; = <span class="built_in">this</span>.data</span><br><span class="line">        videoUpdateTime.splice(videoUpdateTime.findIndex(<span class="function"><span class="params">item</span> =&gt;</span> item.vid === event.currentTarget.id),<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            videoUpdateTime</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 自定义下拉刷新的回调：scroll-view</span></span><br><span class="line">    <span class="function"><span class="title">handleRefresh</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//再次发请求，获取最新的数据</span></span><br><span class="line">        <span class="built_in">this</span>.getVideoList(<span class="built_in">this</span>.data.navId,<span class="built_in">this</span>.data.offset)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 自定义上拉触底的回调：scroll-view</span></span><br><span class="line">    <span class="function"><span class="title">handleToLower</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// 数据的分页： 1、后端分页 2、前端分页</span></span><br><span class="line">        <span class="comment">// 网易云api暂时没有提供分页的api</span></span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            offset: <span class="built_in">this</span>.data.offset + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">this</span>.getVideoList(<span class="built_in">this</span>.data.navId,<span class="built_in">this</span>.data.offset)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 跳转至搜索界面</span></span><br><span class="line">    <span class="function"><span class="title">toSearch</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        wx.navigateTo(&#123;</span><br><span class="line">          url: <span class="string">&#x27;/pages/search/search&#x27;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户点击右上角分享</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    onShareAppMessage: <span class="function"><span class="keyword">function</span>(<span class="params">&#123;<span class="keyword">from</span>&#125;</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> PageObject = getCurrentPages()</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">from</span> === <span class="string">&#x27;button&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                title: <span class="string">&#x27;十点云音乐&#x27;</span>,</span><br><span class="line">                page: PageObject.route[<span class="number">0</span>],</span><br><span class="line">                imageUrl: <span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                title: <span class="string">&#x27;十点云音乐&#x27;</span>,</span><br><span class="line">                page: PageObject.route[<span class="number">0</span>],</span><br><span class="line">                imageUrl: <span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;usingComponents&quot;</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;视频页&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="每日推荐"><a href="#每日推荐" class="headerlink" title="每日推荐"></a>每日推荐</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l50ba43tj30ho0vkdia.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;recommendSongContainer&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 头部 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/recommendSong/recommendSong.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;date&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;day&quot;</span>&gt;</span>&#123;&#123;day&#125;&#125; / <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;month&quot;</span>&gt;</span>&#123;&#123;month&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 列表区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;ListContainer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;listHeader&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span>&gt;</span>播放全部<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;changeMore&quot;</span>&gt;</span>多选<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 内容区 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;listScroll&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;scrollItem&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;recommendSongList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">data-index</span>=<span class="string">&quot;&#123;&#123;index&#125;&#125;&quot;</span> <span class="attr">data-song</span>=<span class="string">&quot;&#123;&#123;item&#125;&#125;&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;toSongDetail&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.al.picUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;musicInfo&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;musicName&quot;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;author&quot;</span>&gt;</span>&#123;&#123;item.ar[0].name&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-gengduo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 头部 */</span></span><br><span class="line"><span class="selector-class">.recommendSongContainer</span> <span class="selector-class">.header</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendSongContainer</span> <span class="selector-class">.header</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.recommendSongContainer</span> <span class="selector-class">.header</span> <span class="selector-class">.date</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">130</span>rpx;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">35</span>rpx;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.header</span> <span class="selector-class">.date</span> <span class="selector-class">.day</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">45</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 列表区域 */</span></span><br><span class="line"><span class="selector-class">.ListContainer</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">30</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.listHeader</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.listHeader</span> text &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.listHeader</span> <span class="selector-class">.changeMore</span>&#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 内容区 */</span></span><br><span class="line"><span class="selector-class">.listScroll</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100vh</span> - <span class="number">380</span>rpx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollItem</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollItem</span> image &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicInfo</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicInfo</span> text &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">400</span>rpx;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.scrollItem</span> <span class="selector-class">.iconfont</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PubSub <span class="keyword">from</span> <span class="string">&#x27;pubsub-js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;../../../utils/request&#x27;</span></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        day: <span class="string">&#x27;&#x27;</span>, <span class="comment">//天</span></span><br><span class="line">        month: <span class="string">&#x27;&#x27;</span>, <span class="comment">//月</span></span><br><span class="line">        recommendSongList: [], <span class="comment">//每日推荐歌曲列表</span></span><br><span class="line">        index: <span class="number">0</span>, <span class="comment">//点击音乐的下标</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 判断用户是否登陆</span></span><br><span class="line">        <span class="keyword">let</span> userInfo = wx.getStorageSync(<span class="string">&#x27;userInfo&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(!userInfo)&#123;</span><br><span class="line">            wx.showToast(&#123;</span><br><span class="line">              title: <span class="string">&#x27;请先登录&#x27;</span>,</span><br><span class="line">              icon: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">              success: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                  wx.reLaunch(&#123;</span><br><span class="line">                    url: <span class="string">&#x27;/pages/login/login&#x27;</span>,</span><br><span class="line">                  &#125;)</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 更新一下日期的状态</span></span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            day: <span class="keyword">new</span> <span class="built_in">Date</span>().getDate(),</span><br><span class="line">            month: <span class="keyword">new</span> <span class="built_in">Date</span>().getMonth() + <span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// 获取每日推荐歌曲</span></span><br><span class="line">        <span class="built_in">this</span>.getRecommedSong()</span><br><span class="line">        <span class="comment">// 订阅来自songDetail页面发布的消息</span></span><br><span class="line">        PubSub.subscribe(<span class="string">&#x27;switchType&#x27;</span>,<span class="function">(<span class="params">msg,data</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> &#123;recommendSongList,index&#125; = <span class="built_in">this</span>.data</span><br><span class="line">            <span class="keyword">if</span>(data === <span class="string">&#x27;pre&#x27;</span>)&#123;</span><br><span class="line">                (index === <span class="number">0</span>) &amp;&amp; (index = recommendSongList.length)</span><br><span class="line">                index -= <span class="number">1</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                (index === recommendSongList.length - <span class="number">1</span>) &amp;&amp; (index = -<span class="number">1</span>)</span><br><span class="line">                index += <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//更新下标</span></span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                index</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">let</span> musicId = recommendSongList[index].id</span><br><span class="line">            <span class="comment">// 将音乐id回传给songDetail</span></span><br><span class="line">            PubSub.publish(<span class="string">&#x27;musicId&#x27;</span>,musicId)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取每日推荐歌曲</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getRecommedSong</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> recommendSongData = <span class="keyword">await</span> request(<span class="string">&#x27;/recommend/songs&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            recommendSongList: recommendSongData.data.dailySongs</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//跳转至songDetail页面</span></span><br><span class="line">    <span class="function"><span class="title">toSongDetail</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> &#123;song,index&#125; = event.currentTarget.dataset</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            index</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//路由跳转传参：query参数</span></span><br><span class="line">        wx.navigateTo(&#123;</span><br><span class="line">          url: <span class="string">&#x27;/songPackage/pages/songDetail/songDetail?musicId=&#x27;</span> + song.id,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;usingComponents&quot;</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">&quot;navigationBarBackgroundColor&quot;</span>: <span class="string">&quot;#91CDF6&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;每日推荐&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="歌曲页"><a href="#歌曲页" class="headerlink" title="歌曲页"></a>歌曲页</h2><img src="http://qn.liuwqtech.top/008vxvgGly1h8l50r2511j30hm0vmabm.jpg" style="zoom:33%;" />

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;songDetailContainer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;author&quot;</span>&gt;</span>&#123;&#123;song.ar[0].name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;circle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;needle &#123;&#123;isPlay &amp;&amp; &#x27;needleRotate&#x27;&#125;&#125;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/song/needle.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;discContainer &#123;&#123;isPlay &amp;&amp; &#x27;discAnimation&#x27;&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;disc&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/song/disc.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;musicImage&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;song.al.picUrl&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 进度条控制区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;progressControl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;currentTime&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 总进度条 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;barControl&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 实时进度条 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;audio-currentTime-Bar&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: &#123;&#123;currentWidth + &#x27;rpx&#x27;&#125;&#125;;&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 小圆球 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;audio-circle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123;durationTime&#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 底部控制播放区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;musicControl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-iconsMusicyemianbofangmoshiShuffle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-shangyishou&quot;</span> <span class="attr">id</span>=<span class="string">&quot;pre&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;handleSwitch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont &#123;&#123;isPlay?&#x27;icon-zanting&#x27;:&#x27;icon-bofang&#x27;&#125;&#125; big&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;handleMusicPlay&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-next&quot;</span> <span class="attr">id</span>=<span class="string">&quot;next&quot;</span> <span class="attr">bindtap</span>=<span class="string">&quot;handleSwitch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-iconsMusicyemianbofangmoshiPlayList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.songDetailContainer</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 底座 */</span></span><br><span class="line"><span class="selector-class">.circle</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">100</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10</span>rpx <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 摇杆 */</span></span><br><span class="line"><span class="selector-class">.needle</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">99</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">60</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">192</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">274</span>rpx;</span><br><span class="line">    <span class="attribute">transform-origin</span>: <span class="number">40</span>rpx <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">20deg</span>);</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.needleRotate</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 磁盘 */</span></span><br><span class="line"><span class="selector-class">.discContainer</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">170</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">598</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">598</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.discAnimation</span> &#123;</span><br><span class="line">    <span class="attribute">animation</span>: disc <span class="number">5s</span> linear infinite;</span><br><span class="line">    <span class="attribute">animation-delay</span>: <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 设置动画帧</span></span><br><span class="line"><span class="comment">    1、from to：使用简单的动画，只有起始帧和结束帧</span></span><br><span class="line"><span class="comment">    2、百分比： 多用于复杂的动画，动画不止两帧</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@keyframes</span> disc &#123;</span><br><span class="line">    <span class="selector-tag">from</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">to</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.disc</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">598</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">598</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicImage</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">370</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">370</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 底部控制区域 */</span></span><br><span class="line"><span class="selector-class">.musicControl</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">40</span>rpx;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicControl</span> text &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">120</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">120</span>rpx;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">50</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.musicControl</span> text<span class="selector-class">.big</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">80</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 进度条控制区域 */</span></span><br><span class="line"><span class="selector-class">.progressControl</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">200</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">640</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">80</span>rpx;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.progressControl</span> text &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.barControl</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">420</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">4</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.4</span>);</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.audio-currentTime-Bar</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">4</span>rpx;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.audio-circle</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: -<span class="number">12</span>rpx;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">5</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">12</span>rpx;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">12</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PubSub <span class="keyword">from</span> <span class="string">&#x27;pubsub-js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Moment <span class="keyword">from</span> <span class="string">&#x27;moment&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&#x27;../../../utils/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//获取全局实例</span></span><br><span class="line"><span class="keyword">const</span> appInstance = getApp()</span><br><span class="line"></span><br><span class="line">Page(&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 页面的初始数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    data: &#123;</span><br><span class="line">        isPlay: <span class="literal">false</span>, <span class="comment">//标识音乐是否在播放</span></span><br><span class="line">        song:&#123;&#125;, <span class="comment">//歌曲详情对象</span></span><br><span class="line">        musicId:<span class="string">&#x27;&#x27;</span>, <span class="comment">//音乐id</span></span><br><span class="line">        musicLink:<span class="string">&#x27;&#x27;</span>, <span class="comment">//音乐的链接</span></span><br><span class="line">        currentTime: <span class="string">&#x27;00:00&#x27;</span>, <span class="comment">//实时时间</span></span><br><span class="line">        durationTime: <span class="string">&#x27;00:00&#x27;</span>, <span class="comment">//总时长</span></span><br><span class="line">        currentWidth: <span class="number">0</span>, <span class="comment">//实时进度条长度</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生命周期函数--监听页面加载</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">onLoad</span>(<span class="params">options</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> musicId = options.musicId</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            musicId</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//获取音乐详情</span></span><br><span class="line">        <span class="built_in">this</span>.getMusicInfo(musicId)</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 问题：如果用户操作系统的控制音乐播放/暂停的按钮，页面不知道，导致页面显示是否播放的状态和真实的音乐播放状态不一致</span></span><br><span class="line"><span class="comment">         * 解决方案：</span></span><br><span class="line"><span class="comment">         *  1、通过控制音频的实例 backgroundAudioManager 去监视音乐的播放/暂停</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">// 判断当前页面音乐是否在播放</span></span><br><span class="line">        <span class="keyword">if</span>(appInstance.globalData.isMusicPlay &amp;&amp; appInstance.globalData.musicId === musicId)&#123;</span><br><span class="line">            <span class="comment">//修改当前页面音乐播放的状态为true</span></span><br><span class="line">            <span class="built_in">this</span>.changePlayState(<span class="literal">true</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 创建控制音乐播放的实例对象</span></span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager = wx.getBackgroundAudioManager()</span><br><span class="line">        <span class="comment">// 监视音乐播放和暂停和停止</span></span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager.onPlay(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.changePlayState(<span class="literal">true</span>)</span><br><span class="line">            appInstance.globalData.musicId = musicId</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager.onPause(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.changePlayState(<span class="literal">false</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager.onStop(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.changePlayState(<span class="literal">false</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//监听音乐实时播放的进度</span></span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager.onTimeUpdate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> currentTime = Moment(<span class="built_in">this</span>.backgroundAudioManager.currentTime * <span class="number">1000</span>).format(<span class="string">&#x27;mm:ss&#x27;</span>)</span><br><span class="line">            <span class="keyword">let</span> currentWidth = (<span class="built_in">this</span>.backgroundAudioManager.currentTime / <span class="built_in">this</span>.backgroundAudioManager.duration) * <span class="number">450</span></span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                currentTime,</span><br><span class="line">                currentWidth</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//监听音乐播放自然结束</span></span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager.onEnded(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">//自动切换至下一首音乐，并自动播放</span></span><br><span class="line">            <span class="comment">//发布消息给recommendSong页面</span></span><br><span class="line">            PubSub.publish(<span class="string">&#x27;switchType&#x27;</span>,<span class="string">&#x27;next&#x27;</span>)</span><br><span class="line">            <span class="comment">//将实时进度条还原为0</span></span><br><span class="line">            <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                currentWidth: <span class="number">0</span>,</span><br><span class="line">                currentTime: <span class="string">&#x27;00:00&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改播放状态的功能函数</span></span><br><span class="line">    <span class="function"><span class="title">changePlayState</span>(<span class="params">isPlay</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            isPlay</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//修改全局音乐播放的状态</span></span><br><span class="line">        appInstance.globalData.isMusicPlay = isPlay</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取音乐详情</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getMusicInfo</span>(<span class="params">musicId</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> songData = <span class="keyword">await</span> request(<span class="string">&#x27;/song/detail&#x27;</span>,&#123;<span class="attr">ids</span>:musicId&#125;,<span class="string">&#x27;GET&#x27;</span>)</span><br><span class="line">        <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">            song: songData.songs[<span class="number">0</span>],</span><br><span class="line">            durationTime: Moment(songData.songs[<span class="number">0</span>].dt).format(<span class="string">&#x27;mm:ss&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//动态修改窗口标题</span></span><br><span class="line">        wx.setNavigationBarTitle(&#123;</span><br><span class="line">          title: <span class="built_in">this</span>.data.song.name,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点击播放/暂停的回调</span></span><br><span class="line">    <span class="function"><span class="title">handleMusicPlay</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> isPlay = !<span class="built_in">this</span>.data.isPlay</span><br><span class="line">        <span class="comment">// this.setData(&#123;</span></span><br><span class="line">        <span class="comment">//     isPlay</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="keyword">let</span> &#123;musicId,musicLink&#125; = <span class="built_in">this</span>.data</span><br><span class="line">        <span class="built_in">this</span>.musicControl(isPlay,musicId,musicLink);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//控制音乐播放/暂停的功能函数</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">musicControl</span>(<span class="params">isPlay,musicId,musicLink</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isPlay)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!musicLink)&#123;</span><br><span class="line">                <span class="comment">// 获取音乐的播放链接</span></span><br><span class="line">                <span class="keyword">let</span> musicLinkData = <span class="keyword">await</span> request(<span class="string">&#x27;/song/url&#x27;</span>,&#123;<span class="attr">id</span>:musicId&#125;)</span><br><span class="line">                musicLink = musicLinkData.data[<span class="number">0</span>].url</span><br><span class="line">                <span class="built_in">this</span>.setData(&#123;</span><br><span class="line">                    musicLink</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">this</span>.backgroundAudioManager.src = musicLink</span><br><span class="line">            <span class="built_in">this</span>.backgroundAudioManager.title = <span class="built_in">this</span>.data.song.name</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.backgroundAudioManager.pause()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//点击切歌</span></span><br><span class="line">    <span class="function"><span class="title">handleSwitch</span>(<span class="params">event</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//获取切歌的类型</span></span><br><span class="line">        <span class="keyword">let</span> type = event.currentTarget.id</span><br><span class="line">        <span class="comment">//关闭当前播放的音乐</span></span><br><span class="line">        <span class="built_in">this</span>.backgroundAudioManager.stop()</span><br><span class="line">        <span class="comment">//订阅来自recommendSong页面</span></span><br><span class="line">        PubSub.subscribe(<span class="string">&#x27;musicId&#x27;</span>,<span class="function">(<span class="params">msg,data</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">//获取音乐详情</span></span><br><span class="line">            <span class="built_in">this</span>.getMusicInfo(data)</span><br><span class="line">            <span class="comment">//自动播放当前音乐</span></span><br><span class="line">            <span class="built_in">this</span>.musicControl(<span class="literal">true</span>,data)</span><br><span class="line">            <span class="comment">//取消订阅</span></span><br><span class="line">            PubSub.unsubscribe(<span class="string">&#x27;musicId&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//发布消息给recommendSong页面</span></span><br><span class="line">        PubSub.publish(<span class="string">&#x27;switchType&#x27;</span>,type)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="config-js"><a href="#config-js" class="headerlink" title="config.js"></a>config.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置服务器相关信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    host: <span class="string">&#x27;https://jk.zhongwangtx.com&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="request-js"><a href="#request-js" class="headerlink" title="request.js"></a>request.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送ajax请求</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1.封装功能函数</span></span><br><span class="line"><span class="comment"> *  - 功能点明确</span></span><br><span class="line"><span class="comment"> *  - 函数内部应该保留固定代码（静态的）</span></span><br><span class="line"><span class="comment"> *  - 将动态的数据抽取成形参，由使用者根据自身的情况动态传入实参</span></span><br><span class="line"><span class="comment"> *  - 一个良好的功能函数应该设置形参的默认值（ES6的形参默认值）</span></span><br><span class="line"><span class="comment"> * 2.封装功能组件</span></span><br><span class="line"><span class="comment"> *  - 功能点明确</span></span><br><span class="line"><span class="comment"> *  - 组件内部应该保留静态代码</span></span><br><span class="line"><span class="comment"> *  - 将动态的数据抽取成props参数，由使用者根据自身的情况以标签属性的形式动态传入props数据</span></span><br><span class="line"><span class="comment"> *  - 一个良好的组件应该设置组件的必要性及数据类型</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">&#x27;./config&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (url, data=&#123;&#125;, method) =&gt; &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        wx.request(&#123;</span><br><span class="line">            url: config.host + url,</span><br><span class="line">            data,</span><br><span class="line">            method,</span><br><span class="line">            header: &#123;</span><br><span class="line">                cookie: wx.getStorageSync(<span class="string">&#x27;cookies&#x27;</span>)?wx.getStorageSync(<span class="string">&#x27;cookies&#x27;</span>).find(<span class="function"><span class="params">item</span> =&gt;</span> item.indexOf(<span class="string">&#x27;MUSIC_U&#x27;</span>) !== -<span class="number">1</span>):<span class="string">&#x27;&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            success:<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(data.isLogin)&#123;</span><br><span class="line">                    wx.setStorage(&#123;</span><br><span class="line">                        key: <span class="string">&#x27;cookies&#x27;</span>,</span><br><span class="line">                        data: res.cookies</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">                resolve(res.data)</span><br><span class="line">            &#125;,</span><br><span class="line">            fail:<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">     &#125;)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="app-js"><a href="#app-js" class="headerlink" title="app.js"></a>app.js</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">App(&#123;</span><br><span class="line">    globalData: &#123;</span><br><span class="line">        isMusicPlay: <span class="literal">false</span>, <span class="comment">//标识是否有音乐在播放</span></span><br><span class="line">        musicId: <span class="string">&#x27;&#x27;</span>, <span class="comment">//音乐id</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="app-json"><a href="#app-json" class="headerlink" title="app.json"></a>app.json</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;pages&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;pages/index/index&quot;</span>,</span><br><span class="line">        <span class="string">&quot;pages/search/search&quot;</span>,</span><br><span class="line">        <span class="string">&quot;pages/video/video&quot;</span>,</span><br><span class="line">        <span class="string">&quot;pages/login/login&quot;</span>,</span><br><span class="line">        <span class="string">&quot;pages/personal/personal&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;window&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;navigationBarBackgroundColor&quot;</span>: <span class="string">&quot;#d43c33&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;十点云音乐&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;navigationBarTextStyle&quot;</span>: <span class="string">&quot;white&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;tabBar&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;color&quot;</span>: <span class="string">&quot;#333&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;selectedColor&quot;</span>: <span class="string">&quot;#d43c33&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;backgroundColor&quot;</span>: <span class="string">&quot;#ffffff&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;list&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span>: <span class="string">&quot;pages/index/index&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;主页&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span>: <span class="string">&quot;/static/images/tabs/tab-home.png&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span>: <span class="string">&quot;/static/images/tabs/tab-home-selected.png&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span>: <span class="string">&quot;pages/video/video&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;视频&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span>: <span class="string">&quot;/static/images/tabs/tab-video.png&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span>: <span class="string">&quot;/static/images/tabs/tab-video-selected.png&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span>: <span class="string">&quot;pages/personal/personal&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;text&quot;</span>: <span class="string">&quot;个人中心&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span>: <span class="string">&quot;/static/images/tabs/tab-my.png&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span>: <span class="string">&quot;/static/images/tabs/tab-my-selected.png&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;style&quot;</span>: <span class="string">&quot;v2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sitemapLocation&quot;</span>: <span class="string">&quot;sitemap.json&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;requiredBackgroundModes&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;audio&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;subpackages&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;root&quot;</span>: <span class="string">&quot;songPackage&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;pages&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;pages/recommendSong/recommendSong&quot;</span>,</span><br><span class="line">                <span class="string">&quot;pages/songDetail/songDetail&quot;</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;preloadRule&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;pages/index/index&quot;</span>:&#123;</span><br><span class="line">            <span class="attr">&quot;packages&quot;</span>: [<span class="string">&quot;songPackage&quot;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;lazyCodeLoading&quot;</span>: <span class="string">&quot;requiredComponents&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="app-wxss"><a href="#app-wxss" class="headerlink" title="app.wxss"></a>app.wxss</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&quot;/static/iconfont/iconfont.wxss&quot;</span>;</span><br><span class="line"></span><br><span class="line">page &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1096463510@qq.com">小新</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://liuwqtech.github.io/2022/11/28/%E5%AE%9E%E6%88%98/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%AE%9E%E6%88%98/%E5%8D%81%E7%82%B9%E4%BA%91%E9%9F%B3%E4%B9%90/">https://liuwqtech.github.io/2022/11/28/实战/小程序实战/十点云音乐/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://liuwqTech.github.io" target="_blank">小新's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AE%9E%E6%88%98/">实战</a></div><div class="post_share"><div class="social-share" data-image="http://qn.liuwqtech.top/008vxvgGly1h8l4rdwqmzj30gk0g6aa2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="http://qn.liuwqtech.top/008i3skNgy1gpw4zwo9g9j30jd0j8wgz.jpg" target="_blank"><img class="post-qr-code-img" src="http://qn.liuwqtech.top/008i3skNgy1gpw4zwo9g9j30jd0j8wgz.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="http://qn.liuwqtech.top/008i3skNgy1gpw504owa0j30ft0im40s.jpg" target="_blank"><img class="post-qr-code-img" src="http://qn.liuwqtech.top/008i3skNgy1gpw504owa0j30ft0im40s.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/11/17/%E5%90%8E%E7%AB%AF/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/Redis6%E8%AF%A6%E8%A7%A3/"><img class="prev-cover" src="http://qn.liuwqtech.top/008vxvgGly1h70aojsh5wj30ku0afjrp.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Redis6详解</div></div></a></div><div class="next-post pull-right"><a href="/2023/03/21/%E7%AE%97%E6%B3%95/%E6%A0%A1%E6%8B%9B%E5%86%B2%E5%88%BA%E9%9B%86%E8%AE%AD/L01-%E8%87%AA%E5%AD%A6%E9%83%A8%E5%88%86(%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E5%B0%8F%E6%8A%80%E5%B7%A7)/"><img class="next-cover" src="http://qn.liuwqtech.top//algorithm/%E5%B0%81%E9%9D%A21.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">L01-自学部分(算法学习小技巧)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/11/01/实战/前后端实战/智慧校园管理系统/" title="智慧校园管理系统"><img class="cover" src="http://qn.liuwqtech.top/008vxvgGly1h7fjaxrovyj317z0u0gno.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-01</div><div class="title">智慧校园管理系统</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">V</span><span class="switch-btn"></span><span class="second-comment">a</span></div></div><div class="comment-wrap"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%B0%8F%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.1.</span> <span class="toc-text">什么是小程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">小程序的优点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%80%E5%8F%91"><span class="toc-number">1.3.</span> <span class="toc-text">小程序开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99"><span class="toc-number">1.3.1.</span> <span class="toc-text">相关资料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%B4%A6%E5%8F%B7"><span class="toc-number">1.3.2.</span> <span class="toc-text">注册小程序账号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%82%A8%E5%A4%87%E7%9F%A5%E8%AF%86"><span class="toc-number">1.4.</span> <span class="toc-text">开发小程序储备知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Flex%E5%B8%83%E5%B1%80"><span class="toc-number">1.4.1.</span> <span class="toc-text">Flex布局</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flex%E5%B1%9E%E6%80%A7"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">flex属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E5%9C%B0%E5%9D%80"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">学习地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86"><span class="toc-number">1.4.2.</span> <span class="toc-text">移动端相关知识</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%83%8F%E7%B4%A0"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">物理像素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E5%A4%87%E7%8B%AC%E7%AB%8B%E5%83%8F%E7%B4%A0-amp-css%E5%83%8F%E7%B4%A0"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">设备独立像素 &amp; css像素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dpr%E6%AF%94-amp-DPI-amp-PPI"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">dpr比 &amp; DPI &amp; PPI</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%80%82%E9%85%8D%E6%96%B9%E6%A1%88"><span class="toc-number">1.4.3.</span> <span class="toc-text">移动端适配方案</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#viewport%E9%80%82%E9%85%8D"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">viewport适配</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rem%E9%80%82%E9%85%8D"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">rem适配</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%89%B9%E7%82%B9"><span class="toc-number">1.5.</span> <span class="toc-text">小程序特点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.5.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%85%8D%E7%BD%AE"><span class="toc-number">1.5.2.</span> <span class="toc-text">小程序配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE-app-json"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">全局配置: app.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE%EF%BC%9A%E9%A1%B5%E9%9D%A2%E5%90%8D%E7%A7%B0-json"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">页面配置：页面名称.json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sitemap%E9%85%8D%E7%BD%AE-sitemap-json"><span class="toc-number">1.5.2.3.</span> <span class="toc-text">sitemap配置: sitemap.json</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A1%86%E6%9E%B6%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.3.</span> <span class="toc-text">小程序框架接口</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#App"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">App</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Page"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">Page</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wxml%E8%AF%AD%E6%B3%95"><span class="toc-number">1.6.</span> <span class="toc-text">wxml语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-number">1.6.1.</span> <span class="toc-text">数据绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">初始化数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">使用数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">修改数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.6.1.4.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A"><span class="toc-number">1.6.2.</span> <span class="toc-text">事件绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%88%86%E7%B1%BB"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">事件分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">绑定事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E6%B5%81%E7%9A%84%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">事件流的三个阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%91%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%BC%A0%E5%8F%82"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">向事件对象传参</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.6.3.</span> <span class="toc-text">生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E5%BA%94%E9%98%B6%E6%AE%B5%E8%AF%B4%E6%98%8E"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">对应阶段说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E5%9B%BE%E7%A4%BA%E8%AF%B4%E6%98%8E"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">官网图示说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E5%AF%B9%E5%BA%94%E5%9C%B0%E5%9D%80"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">官网对应地址</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="toc-number">1.6.4.</span> <span class="toc-text">列表渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E8%AF%B4%E6%98%8E"><span class="toc-number">1.6.4.1.</span> <span class="toc-text">语法说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.6.4.2.</span> <span class="toc-text">注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93"><span class="toc-number">1.6.5.</span> <span class="toc-text">条件渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E8%AF%B4%E6%98%8E-1"><span class="toc-number">1.6.5.1.</span> <span class="toc-text">语法说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wx-if-VS-hidden"><span class="toc-number">1.6.5.2.</span> <span class="toc-text">wx:if VS hidden</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E7%89%88%E4%BD%BF%E7%94%A8"><span class="toc-number">1.6.6.</span> <span class="toc-text">模版使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.6.6.1.</span> <span class="toc-text">定义模板</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E6%A8%A1%E7%89%88"><span class="toc-number">1.6.6.2.</span> <span class="toc-text">引入模版</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.6.6.3.</span> <span class="toc-text">使用模板</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8FAPI"><span class="toc-number">1.7.</span> <span class="toc-text">小程序API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#API%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="toc-number">1.7.1.</span> <span class="toc-text">API使用说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8API"><span class="toc-number">1.7.2.</span> <span class="toc-text">常用API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92"><span class="toc-number">1.8.</span> <span class="toc-text">前后端交互</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98"><span class="toc-number">1.9.</span> <span class="toc-text">事件委托</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8"><span class="toc-number">1.10.</span> <span class="toc-text">本地存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">1.10.1.</span> <span class="toc-text">存入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">1.10.2.</span> <span class="toc-text">读取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">1.10.3.</span> <span class="toc-text">删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">1.10.4.</span> <span class="toc-text">清空数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E7%9B%B8%E5%85%B3"><span class="toc-number">1.11.</span> <span class="toc-text">定义事件相关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E9%80%9A%E4%BF%A1"><span class="toc-number">1.12.</span> <span class="toc-text">页面通信</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BC%A0%E5%8F%82"><span class="toc-number">1.12.1.</span> <span class="toc-text">路由传参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E8%AE%A2%E9%98%85%E5%8F%91%E5%B8%83"><span class="toc-number">1.12.2.</span> <span class="toc-text">消息订阅发布</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eventChannel%E4%BA%8B%E4%BB%B6%E9%80%9A%E9%81%93"><span class="toc-number">1.12.3.</span> <span class="toc-text">eventChannel事件通道</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6"><span class="toc-number">1.13.</span> <span class="toc-text">自定义组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%BB%84%E4%BB%B6"><span class="toc-number">1.13.1.</span> <span class="toc-text">创建组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-number">1.13.2.</span> <span class="toc-text">使用组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8npm%E5%8C%85"><span class="toc-number">1.14.</span> <span class="toc-text">使用npm包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%94%AF%E4%B8%80%E6%A0%87%E8%AF%86-openId"><span class="toc-number">1.15.</span> <span class="toc-text">获取用户唯一标识(openId)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E5%9B%BE%E8%A7%A3"><span class="toc-number">1.15.1.</span> <span class="toc-text">官网图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%B5%81%E7%A8%8B"><span class="toc-number">1.15.2.</span> <span class="toc-text">获取流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%88%86%E5%8C%85"><span class="toc-number">1.16.</span> <span class="toc-text">小程序分包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%88%86%E5%8C%85"><span class="toc-number">1.16.1.</span> <span class="toc-text">为什么要分包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%85%E5%BD%A2%E5%BC%8F"><span class="toc-number">1.16.2.</span> <span class="toc-text">分包形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%84%E5%88%86%E5%8C%85"><span class="toc-number">1.16.3.</span> <span class="toc-text">常规分包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8B%AC%E7%AB%8B%E5%88%86%E5%8C%85"><span class="toc-number">1.16.4.</span> <span class="toc-text">独立分包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%8C%85%E9%A2%84%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.16.5.</span> <span class="toc-text">分包预下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E5%AF%B9%E5%BA%94%E5%9C%B0%E5%9D%80-1"><span class="toc-number">1.16.6.</span> <span class="toc-text">官网对应地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%BD%AC%E5%8F%91%E5%88%86%E4%BA%AB"><span class="toc-number">1.17.</span> <span class="toc-text">小程序转发分享</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E4%BA%AB%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.17.1.</span> <span class="toc-text">分享实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E4%BA%AB%E5%86%85%E5%AE%B9"><span class="toc-number">1.17.2.</span> <span class="toc-text">自定义分享内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B"><span class="toc-number">1.18.</span> <span class="toc-text">小程序支付流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B%E5%AE%98%E7%BD%91%E5%9B%BE%E8%A7%A3"><span class="toc-number">1.18.1.</span> <span class="toc-text">支付流程官网图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E"><span class="toc-number">1.18.2.</span> <span class="toc-text">详细说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%98%E7%BD%91%E5%AF%B9%E5%BA%94%E5%9C%B0%E5%9D%80-2"><span class="toc-number">1.18.3.</span> <span class="toc-text">官网对应地址</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%EF%BC%9ATenCloudMusic"><span class="toc-number">2.</span> <span class="toc-text">实战：TenCloudMusic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E9%A1%B5"><span class="toc-number">2.1.</span> <span class="toc-text">主页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%99%BB%E9%99%86"><span class="toc-number">2.3.</span> <span class="toc-text">登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83"><span class="toc-number">2.4.</span> <span class="toc-text">个人中心</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2"><span class="toc-number">2.5.</span> <span class="toc-text">搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E9%A2%91"><span class="toc-number">2.6.</span> <span class="toc-text">视频</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%8F%E6%97%A5%E6%8E%A8%E8%8D%90"><span class="toc-number">2.7.</span> <span class="toc-text">每日推荐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%8C%E6%9B%B2%E9%A1%B5"><span class="toc-number">2.8.</span> <span class="toc-text">歌曲页</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#config-js"><span class="toc-number">2.9.</span> <span class="toc-text">config.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#request-js"><span class="toc-number">2.10.</span> <span class="toc-text">request.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app-js"><span class="toc-number">2.11.</span> <span class="toc-text">app.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app-json"><span class="toc-number">2.12.</span> <span class="toc-text">app.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#app-wxss"><span class="toc-number">2.13.</span> <span class="toc-text">app.wxss</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('http://qn.liuwqtech.top/008vxvgGly1h8l4rdwqmzj30gk0g6aa2.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By 小新</div><div class="footer_custom_text">Hi, welcome to my <a href="https://liuwqtech.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/a2f109a6.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: 'a2f109a6',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener toc scroll 
  window.removeEventListener('scroll', window.tocScrollFn)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    if (false) {
      location.hash && e.request.responseURL !== location.href ? pjax.loadUrl(location.href) : pjax.loadUrl('/404.html')
      return
    }
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>